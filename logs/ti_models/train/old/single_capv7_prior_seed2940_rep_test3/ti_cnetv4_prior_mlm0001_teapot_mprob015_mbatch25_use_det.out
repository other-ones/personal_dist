INFO:albumentations.check_version:A new version of Albumentations is available: 1.4.14 (you have 1.4.11). Upgrade using: pip install --upgrade albumentations
WARNING:xformers:WARNING[XFORMERS]: xFormers can't load C++/CUDA extensions. xFormers was built for:
    PyTorch 2.1.1+cu121 with CUDA 1201 (you have 2.1.1+cu118)
    Python  3.9.18 (you have 3.9.19)
  Please reinstall xformers (see https://github.com/facebookresearch/xformers#installing-xformers)
  Memory-efficient attention, SwiGLU, sparse and more won't be available.
  Set XFORMERS_MORE_DETAILS=1 for more details
INFO:__main__:Distributed environment: NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda

Mixed precision type: no

/home/twkim/anaconda3/envs/context/lib/python3.9/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
{'variance_type', 'prediction_type', 'clip_sample_range', 'sample_max_value', 'dynamic_thresholding_ratio', 'thresholding', 'timestep_spacing'} was not found in config. Values will be initialized to default values.
{'scaling_factor'} was not found in config. Values will be initialized to default values.
{'resnet_out_scale_factor', 'time_embedding_act_fn', 'num_class_embeds', 'class_embeddings_concat', 'addition_embed_type', 'resnet_time_scale_shift', 'conv_in_kernel', 'cross_attention_norm', 'timestep_post_act', 'upcast_attention', 'addition_time_embed_dim', 'conv_out_kernel', 'addition_embed_type_num_heads', 'time_embedding_dim', 'mid_block_only_cross_attention', 'num_attention_heads', 'dual_cross_attention', 'class_embed_type', 'encoder_hid_dim', 'use_linear_projection', 'mid_block_type', 'transformer_layers_per_block', 'projection_class_embeddings_input_dim', 'encoder_hid_dim_type', 'resnet_skip_time_act', 'time_embedding_type', 'time_cond_proj_dim', 'only_cross_attention'} was not found in config. Values will be initialized to default values.
INFO:__main__:***** Running training *****
INFO:__main__:  Num examples = 10000000
INFO:__main__:  Num Epochs = 1
INFO:__main__:  Instantaneous batch size per device = 1
INFO:__main__:  Total train batch size (w. parallel, distributed & accumulation) = 4
INFO:__main__:  Gradient Accumulation steps = 4
INFO:__main__:  Total optimization steps = 3001
set seed 2940
saved_models/ti_models/single_capv7_prior_seed2940_rep_test3/teapot/ti_cnetv4_prior_mlm0001_teapot_mprob015_mbatch25_use_det/src/command.txt command_path
ti_train.py item
--pretrained_model_name_or_path=runwayml/stable-diffusion-v1-5 item
--train_data_dir1=/data/twkim/diffusion/personalization/collected/images/teapot item
--learnable_property=object item
--placeholder_token1=<teapot> item
--use_det_alg=1 item
--train_prior_concept1=teapot item
--eval_prior_concept1=teapot item
--resolution=512 item
--train_batch_size=1 item
--gradient_accumulation_steps=4 item
--max_train_steps=3001 item
--learning_rate=5e-4 item
--lr_scheduler=constant item
--normalize_mask_embeds=0 item
--lr_warmup_steps=0 item
--output_dir=saved_models/ti_models/single_capv7_prior_seed2940_rep_test3/teapot item
--seed=2940 item
--mask_tokens=[MASK] item
--lambda_mlm=0.001 item
--freeze_mask_embedding=1 item
--cls_net_path=saved_models/mlm_models/sd1_contextnetv4_nonpadding_1e4_unnorm_mprob015_batch150/checkpoints/checkpoint-100000/cls_net_100000_ckpt.pt item
--mask_embed_path=saved_models/mlm_models/sd1_contextnetv4_nonpadding_1e4_unnorm_mprob015_batch150/checkpoints/checkpoint-100000/mask_embeds_100000_ckpt.pt item
--mask_prob=0.15 item
--mlm_target=masked item
--mlm_batch_size=25 item
--scale_lr item
--eval_prompt_type=nonliving item
--train_prompt_type=nonliving item
--silent=0 item
--rev=0 item
--normalize_target1=0 item
--caption_root=../datasets_pkgs/captions/v7 item
--run_name=ti_cnetv4_prior_mlm0001_teapot_mprob015_mbatch25_use_det item
--include_prior_concept=1 item
32 norm_num_groups
320 block_out_channels[0]
32 norm_num_groups
[49409] mask_token_ids
seeded
captions_nonliving_relations	29376
captions_nonliving_styles	378
captions_nonliving_human_interactions	4176
captions_nonliving_backgrounds	552
captions_nonliving_creatives	117
seeded
captions_nonliving_relations	29376
captions_nonliving_styles	378
captions_nonliving_human_interactions	4176
captions_nonliving_backgrounds	552
captions_nonliving_creatives	117
position_ids defined_key-clsnet
final.weight defined_key-clsnet
final.bias defined_key-clsnet
position_embedding.weight defined_key-clsnet
multi_head_attention1.in_proj_weight defined_key-clsnet
multi_head_attention1.in_proj_bias defined_key-clsnet
multi_head_attention1.out_proj.weight defined_key-clsnet
multi_head_attention1.out_proj.bias defined_key-clsnet
feed_forward1.W_ff1.weight defined_key-clsnet
feed_forward1.W_ff1.bias defined_key-clsnet
feed_forward1.W_ff2.weight defined_key-clsnet
feed_forward1.W_ff2.bias defined_key-clsnet
layer_norm1.weight defined_key-clsnet
layer_norm1.bias defined_key-clsnet
multi_head_attention2.in_proj_weight defined_key-clsnet
multi_head_attention2.in_proj_bias defined_key-clsnet
multi_head_attention2.out_proj.weight defined_key-clsnet
multi_head_attention2.out_proj.bias defined_key-clsnet
layer_norm2.weight defined_key-clsnet
layer_norm2.bias defined_key-clsnet

module.position_ids saved_key-clsnet
module.final.weight saved_key-clsnet
module.final.bias saved_key-clsnet
module.position_embedding.weight saved_key-clsnet
module.multi_head_attention1.in_proj_weight saved_key-clsnet
module.multi_head_attention1.in_proj_bias saved_key-clsnet
module.multi_head_attention1.out_proj.weight saved_key-clsnet
module.multi_head_attention1.out_proj.bias saved_key-clsnet
module.feed_forward1.W_ff1.weight saved_key-clsnet
module.feed_forward1.W_ff1.bias saved_key-clsnet
module.feed_forward1.W_ff2.weight saved_key-clsnet
module.feed_forward1.W_ff2.bias saved_key-clsnet
module.layer_norm1.weight saved_key-clsnet
module.layer_norm1.bias saved_key-clsnet
module.multi_head_attention2.in_proj_weight saved_key-clsnet
module.multi_head_attention2.in_proj_bias saved_key-clsnet
module.multi_head_attention2.out_proj.weight saved_key-clsnet
module.multi_head_attention2.out_proj.bias saved_key-clsnet
module.layer_norm2.weight saved_key-clsnet
module.layer_norm2.bias saved_key-clsnet
Steps:   0%|          | 0/3001 [00:00<?, ?it/s]True accepts_keep_fp32_wrapper
{'keep_fp32_wrapper': True} extra_args
INFO:__main__:STEP 0 Running validation... 
 Generating 8 images with prompt: ['a <teapot> teapot in the jungle', 'a <teapot> teapot with a city in the background', 'a <teapot> teapot with a mountain in the background', 'a <teapot> teapot with the Eiffel Tower in the background', 'a <teapot> teapot floating on top of water', 'a <teapot> teapot floating in an ocean of milk', 'a <teapot> teapot on top of the sidewalk in a crowded street', 'a cube shaped <teapot> teapot'].


----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
Step		|0
Raw		|vincent    van        gogh       is         M[auc]     tioning    <teapot>   teapot    
Masked		|vincent    van        gogh       is         [MASK]     tioning    <teapot>   teapot    
Preds		|an         c          gogh       is         M[ni]      ating      teapot     teapot    
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------


  0%|          | 0/25 [00:00<?, ?it/s][A
  4%|▍         | 1/25 [00:00<00:09,  2.62it/s][A
  8%|▊         | 2/25 [00:00<00:08,  2.81it/s][A
 12%|█▏        | 3/25 [00:01<00:07,  2.88it/s][A
 16%|█▌        | 4/25 [00:01<00:07,  2.91it/s][A
 20%|██        | 5/25 [00:01<00:06,  2.93it/s][A
 24%|██▍       | 6/25 [00:02<00:06,  2.94it/s][A
 28%|██▊       | 7/25 [00:02<00:06,  2.95it/s][A
 32%|███▏      | 8/25 [00:02<00:05,  2.95it/s][A
 36%|███▌      | 9/25 [00:03<00:05,  2.95it/s][A
 40%|████      | 10/25 [00:03<00:05,  2.95it/s][A
 44%|████▍     | 11/25 [00:03<00:04,  2.96it/s][A
 48%|████▊     | 12/25 [00:04<00:04,  2.96it/s][A
 52%|█████▏    | 13/25 [00:04<00:04,  2.96it/s][A
 56%|█████▌    | 14/25 [00:04<00:03,  2.96it/s][A
 60%|██████    | 15/25 [00:05<00:03,  2.96it/s][A
 64%|██████▍   | 16/25 [00:05<00:03,  2.96it/s][A
 68%|██████▊   | 17/25 [00:05<00:02,  2.95it/s][A
 72%|███████▏  | 18/25 [00:06<00:02,  2.96it/s][A
 76%|███████▌  | 19/25 [00:06<00:02,  2.95it/s][A
 80%|████████  | 20/25 [00:06<00:01,  2.95it/s][A
 84%|████████▍ | 21/25 [00:07<00:01,  2.95it/s][A
 88%|████████▊ | 22/25 [00:07<00:01,  2.95it/s][A
 92%|█████████▏| 23/25 [00:07<00:00,  2.95it/s][A
 96%|█████████▌| 24/25 [00:08<00:00,  2.95it/s][A
100%|██████████| 25/25 [00:08<00:00,  2.95it/s][A100%|██████████| 25/25 [00:09<00:00,  2.68it/s]
Steps:   0%|          | 0/3001 [00:18<?, ?it/s, loss=0.18, loss_mlm=0.992, lr=0.002, norm_mask=8.02, norm_target=8.42]Steps:   0%|          | 1/3001 [00:18<15:08:10, 18.16s/it, loss=0.18, loss_mlm=0.992, lr=0.002, norm_mask=8.02, norm_target=8.42]Steps:   0%|          | 1/3001 [00:19<15:08:10, 18.16s/it, loss=0.549, loss_mlm=1.12, lr=0.002, norm_mask=8.02, norm_target=8.42]Steps:   0%|          | 2/3001 [00:19<6:54:40,  8.30s/it, loss=0.549, loss_mlm=1.12, lr=0.002, norm_mask=8.02, norm_target=8.42] Steps:   0%|          | 2/3001 [00:20<6:54:40,  8.30s/it, loss=0.104, loss_mlm=0.926, lr=0.002, norm_mask=8.02, norm_target=8.42]Steps:   0%|          | 3/3001 [00:20<4:12:19,  5.05s/it, loss=0.104, loss_mlm=0.926, lr=0.002, norm_mask=8.02, norm_target=8.42]Steps:   0%|          | 3/3001 [00:21<4:12:19,  5.05s/it, loss=0.00509, loss_mlm=0.78, lr=0.002, norm_mask=8.02, norm_target=8.53]Steps:   0%|          | 4/3001 [00:21<2:56:11,  3.53s/it, loss=0.00509, loss_mlm=0.78, lr=0.002, norm_mask=8.02, norm_target=8.53]Steps:   0%|          | 4/3001 [00:23<2:56:11,  3.53s/it, loss=0.00468, loss_mlm=1.26, lr=0.002, norm_mask=8.02, norm_target=8.53]Steps:   0%|          | 5/3001 [00:23<2:13:59,  2.68s/it, loss=0.00468, loss_mlm=1.26, lr=0.002, norm_mask=8.02, norm_target=8.53]Steps:   0%|          | 5/3001 [00:24<2:13:59,  2.68s/it, loss=0.00553, loss_mlm=0.83, lr=0.002, norm_mask=8.02, norm_target=8.53]Steps:   0%|          | 6/3001 [00:24<1:48:46,  2.18s/it, loss=0.00553, loss_mlm=0.83, lr=0.002, norm_mask=8.02, norm_target=8.53]Steps:   0%|          | 6/3001 [00:25<1:48:46,  2.18s/it, loss=0.0254, loss_mlm=0.986, lr=0.002, norm_mask=8.02, norm_target=8.53]Steps:   0%|          | 7/3001 [00:25<1:32:38,  1.86s/it, loss=0.0254, loss_mlm=0.986, lr=0.002, norm_mask=8.02, norm_target=8.53]Steps:   0%|          | 7/3001 [00:26<1:32:38,  1.86s/it, loss=0.144, loss_mlm=1, lr=0.002, norm_mask=8.02, norm_target=8.66]     Steps:   0%|          | 8/3001 [00:26<1:22:07,  1.65s/it, loss=0.144, loss_mlm=1, lr=0.002, norm_mask=8.02, norm_target=8.66]Steps:   0%|          | 8/3001 [00:27<1:22:07,  1.65s/it, loss=0.27, loss_mlm=1.17, lr=0.002, norm_mask=8.02, norm_target=8.66]Steps:   0%|          | 9/3001 [00:27<1:15:04,  1.51s/it, loss=0.27, loss_mlm=1.17, lr=0.002, norm_mask=8.02, norm_target=8.66]Steps:   0%|          | 9/3001 [00:29<1:15:04,  1.51s/it, loss=0.182, loss_mlm=0.763, lr=0.002, norm_mask=8.02, norm_target=8.66]Steps:   0%|          | 10/3001 [00:29<1:10:03,  1.41s/it, loss=0.182, loss_mlm=0.763, lr=0.002, norm_mask=8.02, norm_target=8.66]Steps:   0%|          | 10/3001 [00:30<1:10:03,  1.41s/it, loss=0.0197, loss_mlm=1.06, lr=0.002, norm_mask=8.02, norm_target=8.66]Steps:   0%|          | 11/3001 [00:30<1:06:36,  1.34s/it, loss=0.0197, loss_mlm=1.06, lr=0.002, norm_mask=8.02, norm_target=8.66]Steps:   0%|          | 11/3001 [00:31<1:06:36,  1.34s/it, loss=0.332, loss_mlm=1.08, lr=0.002, norm_mask=8.02, norm_target=8.82] Steps:   0%|          | 12/3001 [00:31<1:04:07,  1.29s/it, loss=0.332, loss_mlm=1.08, lr=0.002, norm_mask=8.02, norm_target=8.82]Steps:   0%|          | 12/3001 [00:32<1:04:07,  1.29s/it, loss=0.0859, loss_mlm=0.929, lr=0.002, norm_mask=8.02, norm_target=8.82]Steps:   0%|          | 13/3001 [00:32<1:02:27,  1.25s/it, loss=0.0859, loss_mlm=0.929, lr=0.002, norm_mask=8.02, norm_target=8.82]Steps:   0%|          | 13/3001 [00:33<1:02:27,  1.25s/it, loss=0.0761, loss_mlm=1.22, lr=0.002, norm_mask=8.02, norm_target=8.82] Steps:   0%|          | 14/3001 [00:33<1:01:16,  1.23s/it, loss=0.0761, loss_mlm=1.22, lr=0.002, norm_mask=8.02, norm_target=8.82]Steps:   0%|          | 14/3001 [00:34<1:01:16,  1.23s/it, loss=0.0167, loss_mlm=0.788, lr=0.002, norm_mask=8.02, norm_target=8.82]Steps:   0%|          | 15/3001 [00:34<1:00:25,  1.21s/it, loss=0.0167, loss_mlm=0.788, lr=0.002, norm_mask=8.02, norm_target=8.82]Steps:   0%|          | 15/3001 [00:36<1:00:25,  1.21s/it, loss=0.0133, loss_mlm=1.22, lr=0.002, norm_mask=8.02, norm_target=8.99] Steps:   1%|          | 16/3001 [00:36<59:53,  1.20s/it, loss=0.0133, loss_mlm=1.22, lr=0.002, norm_mask=8.02, norm_target=8.99]  Steps:   1%|          | 16/3001 [00:37<59:53,  1.20s/it, loss=0.0163, loss_mlm=0.782, lr=0.002, norm_mask=8.02, norm_target=8.99]Steps:   1%|          | 17/3001 [00:37<1:03:41,  1.28s/it, loss=0.0163, loss_mlm=0.782, lr=0.002, norm_mask=8.02, norm_target=8.99]Steps:   1%|          | 17/3001 [00:38<1:03:41,  1.28s/it, loss=0.247, loss_mlm=1.08, lr=0.002, norm_mask=8.02, norm_target=8.99]  Steps:   1%|          | 18/3001 [00:38<1:02:04,  1.25s/it, loss=0.247, loss_mlm=1.08, lr=0.002, norm_mask=8.02, norm_target=8.99]Steps:   1%|          | 18/3001 [00:39<1:02:04,  1.25s/it, loss=0.0201, loss_mlm=1.27, lr=0.002, norm_mask=8.02, norm_target=8.99]Steps:   1%|          | 19/3001 [00:39<1:01:03,  1.23s/it, loss=0.0201, loss_mlm=1.27, lr=0.002, norm_mask=8.02, norm_target=8.99]Steps:   1%|          | 19/3001 [00:41<1:01:03,  1.23s/it, loss=0.00305, loss_mlm=0.723, lr=0.002, norm_mask=8.02, norm_target=9.19]Steps:   1%|          | 20/3001 [00:41<1:00:19,  1.21s/it, loss=0.00305, loss_mlm=0.723, lr=0.002, norm_mask=8.02, norm_target=9.19]Steps:   1%|          | 20/3001 [00:42<1:00:19,  1.21s/it, loss=0.12, loss_mlm=0.874, lr=0.002, norm_mask=8.02, norm_target=9.19]   Steps:   1%|          | 21/3001 [00:42<59:48,  1.20s/it, loss=0.12, loss_mlm=0.874, lr=0.002, norm_mask=8.02, norm_target=9.19]  Steps:   1%|          | 21/3001 [00:43<59:48,  1.20s/it, loss=0.238, loss_mlm=0.822, lr=0.002, norm_mask=8.02, norm_target=9.19]Steps:   1%|          | 22/3001 [00:43<59:54,  1.21s/it, loss=0.238, loss_mlm=0.822, lr=0.002, norm_mask=8.02, norm_target=9.19]Steps:   1%|          | 22/3001 [00:44<59:54,  1.21s/it, loss=0.0682, loss_mlm=0.728, lr=0.002, norm_mask=8.02, norm_target=9.19]Steps:   1%|          | 23/3001 [00:44<59:56,  1.21s/it, loss=0.0682, loss_mlm=0.728, lr=0.002, norm_mask=8.02, norm_target=9.19]Steps:   1%|          | 23/3001 [00:45<59:56,  1.21s/it, loss=0.102, loss_mlm=0.82, lr=0.002, norm_mask=8.02, norm_target=9.37]  Steps:   1%|          | 24/3001 [00:45<59:37,  1.20s/it, loss=0.102, loss_mlm=0.82, lr=0.002, norm_mask=8.02, norm_target=9.37]Steps:   1%|          | 24/3001 [00:47<59:37,  1.20s/it, loss=0.144, loss_mlm=0.758, lr=0.002, norm_mask=8.02, norm_target=9.37]Steps:   1%|          | 25/3001 [00:47<59:24,  1.20s/it, loss=0.144, loss_mlm=0.758, lr=0.002, norm_mask=8.02, norm_target=9.37]Steps:   1%|          | 25/3001 [00:48<59:24,  1.20s/it, loss=0.0113, loss_mlm=1.16, lr=0.002, norm_mask=8.02, norm_target=9.37]Steps:   1%|          | 26/3001 [00:48<59:15,  1.20s/it, loss=0.0113, loss_mlm=1.16, lr=0.002, norm_mask=8.02, norm_target=9.37]Steps:   1%|          | 26/3001 [00:49<59:15,  1.20s/it, loss=0.0157, loss_mlm=0.999, lr=0.002, norm_mask=8.02, norm_target=9.37]Steps:   1%|          | 27/3001 [00:49<59:02,  1.19s/it, loss=0.0157, loss_mlm=0.999, lr=0.002, norm_mask=8.02, norm_target=9.37]Steps:   1%|          | 27/3001 [00:50<59:02,  1.19s/it, loss=0.0209, loss_mlm=0.611, lr=0.002, norm_mask=8.02, norm_target=9.53]Steps:   1%|          | 28/3001 [00:50<58:57,  1.19s/it, loss=0.0209, loss_mlm=0.611, lr=0.002, norm_mask=8.02, norm_target=9.53]Steps:   1%|          | 28/3001 [00:51<58:57,  1.19s/it, loss=0.178, loss_mlm=0.756, lr=0.002, norm_mask=8.02, norm_target=9.53] Steps:   1%|          | 29/3001 [00:51<59:06,  1.19s/it, loss=0.178, loss_mlm=0.756, lr=0.002, norm_mask=8.02, norm_target=9.53]Steps:   1%|          | 29/3001 [00:53<59:06,  1.19s/it, loss=0.0799, loss_mlm=1.05, lr=0.002, norm_mask=8.02, norm_target=9.53]Steps:   1%|          | 30/3001 [00:53<59:05,  1.19s/it, loss=0.0799, loss_mlm=1.05, lr=0.002, norm_mask=8.02, norm_target=9.53]Steps:   1%|          | 30/3001 [00:54<59:05,  1.19s/it, loss=0.215, loss_mlm=1.01, lr=0.002, norm_mask=8.02, norm_target=9.53] Steps:   1%|          | 31/3001 [00:54<58:52,  1.19s/it, loss=0.215, loss_mlm=1.01, lr=0.002, norm_mask=8.02, norm_target=9.53]Steps:   1%|          | 31/3001 [00:55<58:52,  1.19s/it, loss=0.202, loss_mlm=0.576, lr=0.002, norm_mask=8.02, norm_target=9.68]Steps:   1%|          | 32/3001 [00:55<58:46,  1.19s/it, loss=0.202, loss_mlm=0.576, lr=0.002, norm_mask=8.02, norm_target=9.68]Steps:   1%|          | 32/3001 [00:56<58:46,  1.19s/it, loss=0.204, loss_mlm=1.17, lr=0.002, norm_mask=8.02, norm_target=9.68] Steps:   1%|          | 33/3001 [00:56<58:39,  1.19s/it, loss=0.204, loss_mlm=1.17, lr=0.002, norm_mask=8.02, norm_target=9.68]Steps:   1%|          | 33/3001 [00:57<58:39,  1.19s/it, loss=0.0669, loss_mlm=0.848, lr=0.002, norm_mask=8.02, norm_target=9.68]Steps:   1%|          | 34/3001 [00:57<58:33,  1.18s/it, loss=0.0669, loss_mlm=0.848, lr=0.002, norm_mask=8.02, norm_target=9.68]Steps:   1%|          | 34/3001 [00:58<58:33,  1.18s/it, loss=0.0493, loss_mlm=0.735, lr=0.002, norm_mask=8.02, norm_target=9.68]Steps:   1%|          | 35/3001 [00:58<58:28,  1.18s/it, loss=0.0493, loss_mlm=0.735, lr=0.002, norm_mask=8.02, norm_target=9.68]Steps:   1%|          | 35/3001 [01:00<58:28,  1.18s/it, loss=0.0568, loss_mlm=1.14, lr=0.002, norm_mask=8.02, norm_target=9.82] Steps:   1%|          | 36/3001 [01:00<58:31,  1.18s/it, loss=0.0568, loss_mlm=1.14, lr=0.002, norm_mask=8.02, norm_target=9.82]Steps:   1%|          | 36/3001 [01:01<58:31,  1.18s/it, loss=0.0117, loss_mlm=0.741, lr=0.002, norm_mask=8.02, norm_target=9.82]Steps:   1%|          | 37/3001 [01:01<58:33,  1.19s/it, loss=0.0117, loss_mlm=0.741, lr=0.002, norm_mask=8.02, norm_target=9.82]Steps:   1%|          | 37/3001 [01:02<58:33,  1.19s/it, loss=0.0499, loss_mlm=0.924, lr=0.002, norm_mask=8.02, norm_target=9.82]Steps:   1%|▏         | 38/3001 [01:02<1:03:20,  1.28s/it, loss=0.0499, loss_mlm=0.924, lr=0.002, norm_mask=8.02, norm_target=9.82]Steps:   1%|▏         | 38/3001 [01:04<1:03:20,  1.28s/it, loss=0.0213, loss_mlm=0.891, lr=0.002, norm_mask=8.02, norm_target=9.82]Steps:   1%|▏         | 39/3001 [01:04<1:01:59,  1.26s/it, loss=0.0213, loss_mlm=0.891, lr=0.002, norm_mask=8.02, norm_target=9.82]Steps:   1%|▏         | 39/3001 [01:05<1:01:59,  1.26s/it, loss=0.0319, loss_mlm=1.24, lr=0.002, norm_mask=8.02, norm_target=9.96] Steps:   1%|▏         | 40/3001 [01:05<1:00:52,  1.23s/it, loss=0.0319, loss_mlm=1.24, lr=0.002, norm_mask=8.02, norm_target=9.96]Steps:   1%|▏         | 40/3001 [01:06<1:00:52,  1.23s/it, loss=0.00686, loss_mlm=0.743, lr=0.002, norm_mask=8.02, norm_target=9.96]Steps:   1%|▏         | 41/3001 [01:06<1:00:09,  1.22s/it, loss=0.00686, loss_mlm=0.743, lr=0.002, norm_mask=8.02, norm_target=9.96]Steps:   1%|▏         | 41/3001 [01:07<1:00:09,  1.22s/it, loss=0.0734, loss_mlm=0.874, lr=0.002, norm_mask=8.02, norm_target=9.96] Steps:   1%|▏         | 42/3001 [01:07<59:37,  1.21s/it, loss=0.0734, loss_mlm=0.874, lr=0.002, norm_mask=8.02, norm_target=9.96]  Steps:   1%|▏         | 42/3001 [01:08<59:37,  1.21s/it, loss=0.335, loss_mlm=0.905, lr=0.002, norm_mask=8.02, norm_target=9.96] Steps:   1%|▏         | 43/3001 [01:08<59:14,  1.20s/it, loss=0.335, loss_mlm=0.905, lr=0.002, norm_mask=8.02, norm_target=9.96]Steps:   1%|▏         | 43/3001 [01:09<59:14,  1.20s/it, loss=0.00499, loss_mlm=0.992, lr=0.002, norm_mask=8.02, norm_target=10.1]Steps:   1%|▏         | 44/3001 [01:09<58:57,  1.20s/it, loss=0.00499, loss_mlm=0.992, lr=0.002, norm_mask=8.02, norm_target=10.1]Steps:   1%|▏         | 44/3001 [01:11<58:57,  1.20s/it, loss=0.0163, loss_mlm=0.845, lr=0.002, norm_mask=8.02, norm_target=10.1] Steps:   1%|▏         | 45/3001 [01:11<58:51,  1.19s/it, loss=0.0163, loss_mlm=0.845, lr=0.002, norm_mask=8.02, norm_target=10.1]Steps:   1%|▏         | 45/3001 [01:12<58:51,  1.19s/it, loss=0.00511, loss_mlm=0.621, lr=0.002, norm_mask=8.02, norm_target=10.1]Steps:   2%|▏         | 46/3001 [01:12<58:49,  1.19s/it, loss=0.00511, loss_mlm=0.621, lr=0.002, norm_mask=8.02, norm_target=10.1]Steps:   2%|▏         | 46/3001 [01:13<58:49,  1.19s/it, loss=0.00827, loss_mlm=0.891, lr=0.002, norm_mask=8.02, norm_target=10.1]Steps:   2%|▏         | 47/3001 [01:13<58:37,  1.19s/it, loss=0.00827, loss_mlm=0.891, lr=0.002, norm_mask=8.02, norm_target=10.1]Steps:   2%|▏         | 47/3001 [01:14<58:37,  1.19s/it, loss=0.459, loss_mlm=1.14, lr=0.002, norm_mask=8.02, norm_target=10.2]   Steps:   2%|▏         | 48/3001 [01:14<58:27,  1.19s/it, loss=0.459, loss_mlm=1.14, lr=0.002, norm_mask=8.02, norm_target=10.2]Steps:   2%|▏         | 48/3001 [01:15<58:27,  1.19s/it, loss=0.00327, loss_mlm=0.991, lr=0.002, norm_mask=8.02, norm_target=10.2]Steps:   2%|▏         | 49/3001 [01:15<58:25,  1.19s/it, loss=0.00327, loss_mlm=0.991, lr=0.002, norm_mask=8.02, norm_target=10.2]Steps:   2%|▏         | 49/3001 [01:17<58:25,  1.19s/it, loss=0.00491, loss_mlm=1.11, lr=0.002, norm_mask=8.02, norm_target=10.2] Steps:   2%|▏         | 50/3001 [01:17<58:19,  1.19s/it, loss=0.00491, loss_mlm=1.11, lr=0.002, norm_mask=8.02, norm_target=10.2]Steps:   2%|▏         | 50/3001 [01:18<58:19,  1.19s/it, loss=0.0104, loss_mlm=0.926, lr=0.002, norm_mask=8.02, norm_target=10.2]Steps:   2%|▏         | 51/3001 [01:18<58:12,  1.18s/it, loss=0.0104, loss_mlm=0.926, lr=0.002, norm_mask=8.02, norm_target=10.2]Steps:   2%|▏         | 51/3001 [01:19<58:12,  1.18s/it, loss=0.46, loss_mlm=1.14, lr=0.002, norm_mask=8.02, norm_target=10.4]   Steps:   2%|▏         | 52/3001 [01:19<58:13,  1.18s/it, loss=0.46, loss_mlm=1.14, lr=0.002, norm_mask=8.02, norm_target=10.4]Steps:   2%|▏         | 52/3001 [01:20<58:13,  1.18s/it, loss=0.00321, loss_mlm=1.29, lr=0.002, norm_mask=8.02, norm_target=10.4]Steps:   2%|▏         | 53/3001 [01:20<58:12,  1.18s/it, loss=0.00321, loss_mlm=1.29, lr=0.002, norm_mask=8.02, norm_target=10.4]Steps:   2%|▏         | 53/3001 [01:21<58:12,  1.18s/it, loss=0.00551, loss_mlm=0.874, lr=0.002, norm_mask=8.02, norm_target=10.4]Steps:   2%|▏         | 54/3001 [01:21<58:11,  1.18s/it, loss=0.00551, loss_mlm=0.874, lr=0.002, norm_mask=8.02, norm_target=10.4]Steps:   2%|▏         | 54/3001 [01:23<58:11,  1.18s/it, loss=0.0536, loss_mlm=0.99, lr=0.002, norm_mask=8.02, norm_target=10.4]  Steps:   2%|▏         | 55/3001 [01:23<58:05,  1.18s/it, loss=0.0536, loss_mlm=0.99, lr=0.002, norm_mask=8.02, norm_target=10.4]Steps:   2%|▏         | 55/3001 [01:24<58:05,  1.18s/it, loss=0.34, loss_mlm=1.01, lr=0.002, norm_mask=8.02, norm_target=10.5]  Steps:   2%|▏         | 56/3001 [01:24<58:01,  1.18s/it, loss=0.34, loss_mlm=1.01, lr=0.002, norm_mask=8.02, norm_target=10.5]Steps:   2%|▏         | 56/3001 [01:25<58:01,  1.18s/it, loss=0.369, loss_mlm=1.05, lr=0.002, norm_mask=8.02, norm_target=10.5]Steps:   2%|▏         | 57/3001 [01:25<57:58,  1.18s/it, loss=0.369, loss_mlm=1.05, lr=0.002, norm_mask=8.02, norm_target=10.5]Steps:   2%|▏         | 57/3001 [01:26<57:58,  1.18s/it, loss=0.124, loss_mlm=1.2, lr=0.002, norm_mask=8.02, norm_target=10.5] Steps:   2%|▏         | 58/3001 [01:26<58:47,  1.20s/it, loss=0.124, loss_mlm=1.2, lr=0.002, norm_mask=8.02, norm_target=10.5]Steps:   2%|▏         | 58/3001 [01:27<58:47,  1.20s/it, loss=0.0727, loss_mlm=1.18, lr=0.002, norm_mask=8.02, norm_target=10.5]Steps:   2%|▏         | 59/3001 [01:27<58:48,  1.20s/it, loss=0.0727, loss_mlm=1.18, lr=0.002, norm_mask=8.02, norm_target=10.5]Steps:   2%|▏         | 59/3001 [01:29<58:48,  1.20s/it, loss=0.0194, loss_mlm=1.15, lr=0.002, norm_mask=8.02, norm_target=10.6]Steps:   2%|▏         | 60/3001 [01:29<1:03:03,  1.29s/it, loss=0.0194, loss_mlm=1.15, lr=0.002, norm_mask=8.02, norm_target=10.6]Steps:   2%|▏         | 60/3001 [01:30<1:03:03,  1.29s/it, loss=0.0161, loss_mlm=1.21, lr=0.002, norm_mask=8.02, norm_target=10.6]Steps:   2%|▏         | 61/3001 [01:30<1:01:47,  1.26s/it, loss=0.0161, loss_mlm=1.21, lr=0.002, norm_mask=8.02, norm_target=10.6]Steps:   2%|▏         | 61/3001 [01:31<1:01:47,  1.26s/it, loss=0.307, loss_mlm=1.05, lr=0.002, norm_mask=8.02, norm_target=10.6] Steps:   2%|▏         | 62/3001 [01:31<1:00:41,  1.24s/it, loss=0.307, loss_mlm=1.05, lr=0.002, norm_mask=8.02, norm_target=10.6]Steps:   2%|▏         | 62/3001 [01:32<1:00:41,  1.24s/it, loss=0.0403, loss_mlm=1.11, lr=0.002, norm_mask=8.02, norm_target=10.6]Steps:   2%|▏         | 63/3001 [01:32<1:00:05,  1.23s/it, loss=0.0403, loss_mlm=1.11, lr=0.002, norm_mask=8.02, norm_target=10.6]Steps:   2%|▏         | 63/3001 [01:34<1:00:05,  1.23s/it, loss=0.12, loss_mlm=0.746, lr=0.002, norm_mask=8.02, norm_target=10.7] Steps:   2%|▏         | 64/3001 [01:34<59:45,  1.22s/it, loss=0.12, loss_mlm=0.746, lr=0.002, norm_mask=8.02, norm_target=10.7]  Steps:   2%|▏         | 64/3001 [01:35<59:45,  1.22s/it, loss=0.055, loss_mlm=1.22, lr=0.002, norm_mask=8.02, norm_target=10.7]Steps:   2%|▏         | 65/3001 [01:35<59:19,  1.21s/it, loss=0.055, loss_mlm=1.22, lr=0.002, norm_mask=8.02, norm_target=10.7]Steps:   2%|▏         | 65/3001 [01:36<59:19,  1.21s/it, loss=0.00997, loss_mlm=1.21, lr=0.002, norm_mask=8.02, norm_target=10.7]Steps:   2%|▏         | 66/3001 [01:36<58:56,  1.20s/it, loss=0.00997, loss_mlm=1.21, lr=0.002, norm_mask=8.02, norm_target=10.7]Steps:   2%|▏         | 66/3001 [01:37<58:56,  1.20s/it, loss=0.0906, loss_mlm=1.21, lr=0.002, norm_mask=8.02, norm_target=10.7] Steps:   2%|▏         | 67/3001 [01:37<58:55,  1.20s/it, loss=0.0906, loss_mlm=1.21, lr=0.002, norm_mask=8.02, norm_target=10.7]Steps:   2%|▏         | 67/3001 [01:38<58:55,  1.20s/it, loss=0.0194, loss_mlm=1.32, lr=0.002, norm_mask=8.02, norm_target=10.9]Steps:   2%|▏         | 68/3001 [01:38<58:57,  1.21s/it, loss=0.0194, loss_mlm=1.32, lr=0.002, norm_mask=8.02, norm_target=10.9]Steps:   2%|▏         | 68/3001 [01:40<58:57,  1.21s/it, loss=0.0264, loss_mlm=0.877, lr=0.002, norm_mask=8.02, norm_target=10.9]Steps:   2%|▏         | 69/3001 [01:40<58:48,  1.20s/it, loss=0.0264, loss_mlm=0.877, lr=0.002, norm_mask=8.02, norm_target=10.9]Steps:   2%|▏         | 69/3001 [01:41<58:48,  1.20s/it, loss=0.115, loss_mlm=0.905, lr=0.002, norm_mask=8.02, norm_target=10.9] Steps:   2%|▏         | 70/3001 [01:41<58:34,  1.20s/it, loss=0.115, loss_mlm=0.905, lr=0.002, norm_mask=8.02, norm_target=10.9]Steps:   2%|▏         | 70/3001 [01:42<58:34,  1.20s/it, loss=0.0885, loss_mlm=0.908, lr=0.002, norm_mask=8.02, norm_target=10.9]Steps:   2%|▏         | 71/3001 [01:42<58:26,  1.20s/it, loss=0.0885, loss_mlm=0.908, lr=0.002, norm_mask=8.02, norm_target=10.9]Steps:   2%|▏         | 71/3001 [01:43<58:26,  1.20s/it, loss=0.179, loss_mlm=0.628, lr=0.002, norm_mask=8.02, norm_target=11]   Steps:   2%|▏         | 72/3001 [01:43<58:45,  1.20s/it, loss=0.179, loss_mlm=0.628, lr=0.002, norm_mask=8.02, norm_target=11]Steps:   2%|▏         | 72/3001 [01:44<58:45,  1.20s/it, loss=0.749, loss_mlm=0.891, lr=0.002, norm_mask=8.02, norm_target=11]Steps:   2%|▏         | 73/3001 [01:44<58:58,  1.21s/it, loss=0.749, loss_mlm=0.891, lr=0.002, norm_mask=8.02, norm_target=11]Steps:   2%|▏         | 73/3001 [01:46<58:58,  1.21s/it, loss=0.254, loss_mlm=1.17, lr=0.002, norm_mask=8.02, norm_target=11] Steps:   2%|▏         | 74/3001 [01:46<58:51,  1.21s/it, loss=0.254, loss_mlm=1.17, lr=0.002, norm_mask=8.02, norm_target=11]Steps:   2%|▏         | 74/3001 [01:47<58:51,  1.21s/it, loss=0.119, loss_mlm=0.882, lr=0.002, norm_mask=8.02, norm_target=11]Steps:   2%|▏         | 75/3001 [01:47<58:56,  1.21s/it, loss=0.119, loss_mlm=0.882, lr=0.002, norm_mask=8.02, norm_target=11]Steps:   2%|▏         | 75/3001 [01:48<58:56,  1.21s/it, loss=0.00633, loss_mlm=0.877, lr=0.002, norm_mask=8.02, norm_target=11.1]Steps:   3%|▎         | 76/3001 [01:48<58:57,  1.21s/it, loss=0.00633, loss_mlm=0.877, lr=0.002, norm_mask=8.02, norm_target=11.1]Steps:   3%|▎         | 76/3001 [01:49<58:57,  1.21s/it, loss=0.0564, loss_mlm=1.35, lr=0.002, norm_mask=8.02, norm_target=11.1]  Steps:   3%|▎         | 77/3001 [01:49<58:55,  1.21s/it, loss=0.0564, loss_mlm=1.35, lr=0.002, norm_mask=8.02, norm_target=11.1]Steps:   3%|▎         | 77/3001 [01:50<58:55,  1.21s/it, loss=0.0073, loss_mlm=0.893, lr=0.002, norm_mask=8.02, norm_target=11.1]Steps:   3%|▎         | 78/3001 [01:50<58:41,  1.20s/it, loss=0.0073, loss_mlm=0.893, lr=0.002, norm_mask=8.02, norm_target=11.1]Steps:   3%|▎         | 78/3001 [01:52<58:41,  1.20s/it, loss=0.02, loss_mlm=1.06, lr=0.002, norm_mask=8.02, norm_target=11.1]   Steps:   3%|▎         | 79/3001 [01:52<58:37,  1.20s/it, loss=0.02, loss_mlm=1.06, lr=0.002, norm_mask=8.02, norm_target=11.1]Steps:   3%|▎         | 79/3001 [01:53<58:37,  1.20s/it, loss=0.138, loss_mlm=1.05, lr=0.002, norm_mask=8.02, norm_target=11.2]Steps:   3%|▎         | 80/3001 [01:53<58:33,  1.20s/it, loss=0.138, loss_mlm=1.05, lr=0.002, norm_mask=8.02, norm_target=11.2]Steps:   3%|▎         | 80/3001 [01:54<58:33,  1.20s/it, loss=0.0966, loss_mlm=0.798, lr=0.002, norm_mask=8.02, norm_target=11.2]Steps:   3%|▎         | 81/3001 [01:54<1:02:57,  1.29s/it, loss=0.0966, loss_mlm=0.798, lr=0.002, norm_mask=8.02, norm_target=11.2]Steps:   3%|▎         | 81/3001 [01:56<1:02:57,  1.29s/it, loss=0.0097, loss_mlm=1.23, lr=0.002, norm_mask=8.02, norm_target=11.2] Steps:   3%|▎         | 82/3001 [01:56<1:01:38,  1.27s/it, loss=0.0097, loss_mlm=1.23, lr=0.002, norm_mask=8.02, norm_target=11.2]Steps:   3%|▎         | 82/3001 [01:57<1:01:38,  1.27s/it, loss=0.0549, loss_mlm=1.18, lr=0.002, norm_mask=8.02, norm_target=11.2]Steps:   3%|▎         | 83/3001 [01:57<1:00:33,  1.25s/it, loss=0.0549, loss_mlm=1.18, lr=0.002, norm_mask=8.02, norm_target=11.2]Steps:   3%|▎         | 83/3001 [01:58<1:00:33,  1.25s/it, loss=0.398, loss_mlm=0.99, lr=0.002, norm_mask=8.02, norm_target=11.3] Steps:   3%|▎         | 84/3001 [01:58<59:44,  1.23s/it, loss=0.398, loss_mlm=0.99, lr=0.002, norm_mask=8.02, norm_target=11.3]  Steps:   3%|▎         | 84/3001 [01:59<59:44,  1.23s/it, loss=0.0588, loss_mlm=0.571, lr=0.002, norm_mask=8.02, norm_target=11.3]Steps:   3%|▎         | 85/3001 [01:59<59:09,  1.22s/it, loss=0.0588, loss_mlm=0.571, lr=0.002, norm_mask=8.02, norm_target=11.3]Steps:   3%|▎         | 85/3001 [02:00<59:09,  1.22s/it, loss=0.37, loss_mlm=1.13, lr=0.002, norm_mask=8.02, norm_target=11.3]   Steps:   3%|▎         | 86/3001 [02:00<58:46,  1.21s/it, loss=0.37, loss_mlm=1.13, lr=0.002, norm_mask=8.02, norm_target=11.3]Steps:   3%|▎         | 86/3001 [02:02<58:46,  1.21s/it, loss=0.0105, loss_mlm=0.871, lr=0.002, norm_mask=8.02, norm_target=11.3]Steps:   3%|▎         | 87/3001 [02:02<58:37,  1.21s/it, loss=0.0105, loss_mlm=0.871, lr=0.002, norm_mask=8.02, norm_target=11.3]Steps:   3%|▎         | 87/3001 [02:03<58:37,  1.21s/it, loss=0.0319, loss_mlm=1.3, lr=0.002, norm_mask=8.02, norm_target=11.4]  Steps:   3%|▎         | 88/3001 [02:03<58:27,  1.20s/it, loss=0.0319, loss_mlm=1.3, lr=0.002, norm_mask=8.02, norm_target=11.4]Steps:   3%|▎         | 88/3001 [02:04<58:27,  1.20s/it, loss=0.0116, loss_mlm=1.05, lr=0.002, norm_mask=8.02, norm_target=11.4]Steps:   3%|▎         | 89/3001 [02:04<58:24,  1.20s/it, loss=0.0116, loss_mlm=1.05, lr=0.002, norm_mask=8.02, norm_target=11.4]Steps:   3%|▎         | 89/3001 [02:05<58:24,  1.20s/it, loss=0.0255, loss_mlm=1.18, lr=0.002, norm_mask=8.02, norm_target=11.4]Steps:   3%|▎         | 90/3001 [02:05<58:32,  1.21s/it, loss=0.0255, loss_mlm=1.18, lr=0.002, norm_mask=8.02, norm_target=11.4]Steps:   3%|▎         | 90/3001 [02:06<58:32,  1.21s/it, loss=0.124, loss_mlm=0.786, lr=0.002, norm_mask=8.02, norm_target=11.4]Steps:   3%|▎         | 91/3001 [02:06<58:33,  1.21s/it, loss=0.124, loss_mlm=0.786, lr=0.002, norm_mask=8.02, norm_target=11.4]Steps:   3%|▎         | 91/3001 [02:08<58:33,  1.21s/it, loss=0.0157, loss_mlm=0.952, lr=0.002, norm_mask=8.02, norm_target=11.5]Steps:   3%|▎         | 92/3001 [02:08<58:23,  1.20s/it, loss=0.0157, loss_mlm=0.952, lr=0.002, norm_mask=8.02, norm_target=11.5]Steps:   3%|▎         | 92/3001 [02:09<58:23,  1.20s/it, loss=0.0309, loss_mlm=0.896, lr=0.002, norm_mask=8.02, norm_target=11.5]Steps:   3%|▎         | 93/3001 [02:09<58:26,  1.21s/it, loss=0.0309, loss_mlm=0.896, lr=0.002, norm_mask=8.02, norm_target=11.5]Steps:   3%|▎         | 93/3001 [02:10<58:26,  1.21s/it, loss=0.0109, loss_mlm=0.814, lr=0.002, norm_mask=8.02, norm_target=11.5]Steps:   3%|▎         | 94/3001 [02:10<58:14,  1.20s/it, loss=0.0109, loss_mlm=0.814, lr=0.002, norm_mask=8.02, norm_target=11.5]Steps:   3%|▎         | 94/3001 [02:11<58:14,  1.20s/it, loss=0.0325, loss_mlm=1.4, lr=0.002, norm_mask=8.02, norm_target=11.5]  Steps:   3%|▎         | 95/3001 [02:11<58:01,  1.20s/it, loss=0.0325, loss_mlm=1.4, lr=0.002, norm_mask=8.02, norm_target=11.5]Steps:   3%|▎         | 95/3001 [02:12<58:01,  1.20s/it, loss=0.117, loss_mlm=0.826, lr=0.002, norm_mask=8.02, norm_target=11.6]Steps:   3%|▎         | 96/3001 [02:12<57:59,  1.20s/it, loss=0.117, loss_mlm=0.826, lr=0.002, norm_mask=8.02, norm_target=11.6]Steps:   3%|▎         | 96/3001 [02:14<57:59,  1.20s/it, loss=0.202, loss_mlm=0.93, lr=0.002, norm_mask=8.02, norm_target=11.6] Steps:   3%|▎         | 97/3001 [02:14<58:08,  1.20s/it, loss=0.202, loss_mlm=0.93, lr=0.002, norm_mask=8.02, norm_target=11.6]Steps:   3%|▎         | 97/3001 [02:15<58:08,  1.20s/it, loss=0.00956, loss_mlm=1.16, lr=0.002, norm_mask=8.02, norm_target=11.6]Steps:   3%|▎         | 98/3001 [02:15<57:50,  1.20s/it, loss=0.00956, loss_mlm=1.16, lr=0.002, norm_mask=8.02, norm_target=11.6]Steps:   3%|▎         | 98/3001 [02:16<57:50,  1.20s/it, loss=0.00852, loss_mlm=1.09, lr=0.002, norm_mask=8.02, norm_target=11.6]Steps:   3%|▎         | 99/3001 [02:16<57:39,  1.19s/it, loss=0.00852, loss_mlm=1.09, lr=0.002, norm_mask=8.02, norm_target=11.6]Steps:   3%|▎         | 99/3001 [02:17<57:39,  1.19s/it, loss=0.0924, loss_mlm=0.849, lr=0.002, norm_mask=8.02, norm_target=11.7]Steps:   3%|▎         | 100/3001 [02:17<57:37,  1.19s/it, loss=0.0924, loss_mlm=0.849, lr=0.002, norm_mask=8.02, norm_target=11.7]INFO:__main__:STEP 100 Running validation... 
 Generating 8 images with prompt: ['a <teapot> teapot in the jungle', 'a <teapot> teapot with a city in the background', 'a <teapot> teapot with a mountain in the background', 'a <teapot> teapot with the Eiffel Tower in the background', 'a <teapot> teapot floating on top of water', 'a <teapot> teapot floating in an ocean of milk', 'a <teapot> teapot on top of the sidewalk in a crowded street', 'a cube shaped <teapot> teapot'].
Generated


----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
Step		|100
Raw		|M[a]       close      -          M[up]      photo      of         the        <teapot>   teapot     over       a          white      basketball
Masked		|[MASK]     close      -          [MASK]     photo      of         the        <teapot>   teapot     over       a          white      basketball
Preds		|M[a]       close      -          M[up]      photo      of         the        teapot     teapot     over       a          white      basketball
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------


  0%|          | 0/25 [00:00<?, ?it/s][A
  4%|▍         | 1/25 [00:00<00:08,  2.92it/s][A
  8%|▊         | 2/25 [00:00<00:07,  2.92it/s][A
 12%|█▏        | 3/25 [00:01<00:07,  2.92it/s][A
 16%|█▌        | 4/25 [00:01<00:07,  2.91it/s][A
 20%|██        | 5/25 [00:01<00:06,  2.91it/s][A
 24%|██▍       | 6/25 [00:02<00:06,  2.91it/s][A
 28%|██▊       | 7/25 [00:02<00:06,  2.91it/s][A
 32%|███▏      | 8/25 [00:02<00:05,  2.91it/s][A
 36%|███▌      | 9/25 [00:03<00:05,  2.91it/s][A
 40%|████      | 10/25 [00:03<00:05,  2.91it/s][A
 44%|████▍     | 11/25 [00:03<00:04,  2.92it/s][A
 48%|████▊     | 12/25 [00:04<00:04,  2.92it/s][A
 52%|█████▏    | 13/25 [00:04<00:04,  2.92it/s][A
 56%|█████▌    | 14/25 [00:04<00:03,  2.93it/s][A
 60%|██████    | 15/25 [00:05<00:03,  2.93it/s][A
 64%|██████▍   | 16/25 [00:05<00:03,  2.93it/s][A
 68%|██████▊   | 17/25 [00:05<00:02,  2.93it/s][A
 72%|███████▏  | 18/25 [00:06<00:02,  2.93it/s][A
 76%|███████▌  | 19/25 [00:06<00:02,  2.93it/s][A
 80%|████████  | 20/25 [00:06<00:01,  2.93it/s][A
 84%|████████▍ | 21/25 [00:07<00:01,  2.93it/s][A
 88%|████████▊ | 22/25 [00:07<00:01,  2.93it/s][A
 92%|█████████▏| 23/25 [00:07<00:00,  2.93it/s][A
 96%|█████████▌| 24/25 [00:08<00:00,  2.93it/s][A
100%|██████████| 25/25 [00:08<00:00,  2.93it/s][A100%|██████████| 25/25 [00:09<00:00,  2.66it/s]
Steps:   3%|▎         | 100/3001 [02:32<57:37,  1.19s/it, loss=0.381, loss_mlm=1.08, lr=0.002, norm_mask=8.02, norm_target=11.7]  Steps:   3%|▎         | 101/3001 [02:32<4:16:59,  5.32s/it, loss=0.381, loss_mlm=1.08, lr=0.002, norm_mask=8.02, norm_target=11.7]Steps:   3%|▎         | 101/3001 [02:34<4:16:59,  5.32s/it, loss=0.00884, loss_mlm=0.851, lr=0.002, norm_mask=8.02, norm_target=11.7]Steps:   3%|▎         | 102/3001 [02:34<3:22:42,  4.20s/it, loss=0.00884, loss_mlm=0.851, lr=0.002, norm_mask=8.02, norm_target=11.7]Steps:   3%|▎         | 102/3001 [02:35<3:22:42,  4.20s/it, loss=0.0318, loss_mlm=0.687, lr=0.002, norm_mask=8.02, norm_target=11.7] Steps:   3%|▎         | 103/3001 [02:35<2:39:13,  3.30s/it, loss=0.0318, loss_mlm=0.687, lr=0.002, norm_mask=8.02, norm_target=11.7]Steps:   3%|▎         | 103/3001 [02:36<2:39:13,  3.30s/it, loss=0.167, loss_mlm=0.825, lr=0.002, norm_mask=8.02, norm_target=11.8] Steps:   3%|▎         | 104/3001 [02:36<2:08:34,  2.66s/it, loss=0.167, loss_mlm=0.825, lr=0.002, norm_mask=8.02, norm_target=11.8]Steps:   3%|▎         | 104/3001 [02:37<2:08:34,  2.66s/it, loss=0.306, loss_mlm=0.742, lr=0.002, norm_mask=8.02, norm_target=11.8]Steps:   3%|▎         | 105/3001 [02:37<1:47:10,  2.22s/it, loss=0.306, loss_mlm=0.742, lr=0.002, norm_mask=8.02, norm_target=11.8]Steps:   3%|▎         | 105/3001 [02:38<1:47:10,  2.22s/it, loss=0.369, loss_mlm=1.13, lr=0.002, norm_mask=8.02, norm_target=11.8] Steps:   4%|▎         | 106/3001 [02:38<1:32:09,  1.91s/it, loss=0.369, loss_mlm=1.13, lr=0.002, norm_mask=8.02, norm_target=11.8]Steps:   4%|▎         | 106/3001 [02:40<1:32:09,  1.91s/it, loss=0.143, loss_mlm=0.739, lr=0.002, norm_mask=8.02, norm_target=11.8]Steps:   4%|▎         | 107/3001 [02:40<1:21:39,  1.69s/it, loss=0.143, loss_mlm=0.739, lr=0.002, norm_mask=8.02, norm_target=11.8]Steps:   4%|▎         | 107/3001 [02:41<1:21:39,  1.69s/it, loss=0.0143, loss_mlm=0.887, lr=0.002, norm_mask=8.02, norm_target=11.9]Steps:   4%|▎         | 108/3001 [02:41<1:14:18,  1.54s/it, loss=0.0143, loss_mlm=0.887, lr=0.002, norm_mask=8.02, norm_target=11.9]Steps:   4%|▎         | 108/3001 [02:42<1:14:18,  1.54s/it, loss=0.314, loss_mlm=0.798, lr=0.002, norm_mask=8.02, norm_target=11.9] Steps:   4%|▎         | 109/3001 [02:42<1:09:10,  1.44s/it, loss=0.314, loss_mlm=0.798, lr=0.002, norm_mask=8.02, norm_target=11.9]Steps:   4%|▎         | 109/3001 [02:43<1:09:10,  1.44s/it, loss=0.118, loss_mlm=1.21, lr=0.002, norm_mask=8.02, norm_target=11.9] Steps:   4%|▎         | 110/3001 [02:43<1:05:34,  1.36s/it, loss=0.118, loss_mlm=1.21, lr=0.002, norm_mask=8.02, norm_target=11.9]Steps:   4%|▎         | 110/3001 [02:44<1:05:34,  1.36s/it, loss=0.066, loss_mlm=0.596, lr=0.002, norm_mask=8.02, norm_target=11.9]Steps:   4%|▎         | 111/3001 [02:44<1:03:02,  1.31s/it, loss=0.066, loss_mlm=0.596, lr=0.002, norm_mask=8.02, norm_target=11.9]Steps:   4%|▎         | 111/3001 [02:46<1:03:02,  1.31s/it, loss=0.0977, loss_mlm=1.06, lr=0.002, norm_mask=8.02, norm_target=12]  Steps:   4%|▎         | 112/3001 [02:46<1:01:18,  1.27s/it, loss=0.0977, loss_mlm=1.06, lr=0.002, norm_mask=8.02, norm_target=12]Steps:   4%|▎         | 112/3001 [02:47<1:01:18,  1.27s/it, loss=0.0738, loss_mlm=0.947, lr=0.002, norm_mask=8.02, norm_target=12]Steps:   4%|▍         | 113/3001 [02:47<1:00:03,  1.25s/it, loss=0.0738, loss_mlm=0.947, lr=0.002, norm_mask=8.02, norm_target=12]Steps:   4%|▍         | 113/3001 [02:48<1:00:03,  1.25s/it, loss=0.023, loss_mlm=0.904, lr=0.002, norm_mask=8.02, norm_target=12] Steps:   4%|▍         | 114/3001 [02:48<59:12,  1.23s/it, loss=0.023, loss_mlm=0.904, lr=0.002, norm_mask=8.02, norm_target=12]  Steps:   4%|▍         | 114/3001 [02:49<59:12,  1.23s/it, loss=0.478, loss_mlm=1.25, lr=0.002, norm_mask=8.02, norm_target=12] Steps:   4%|▍         | 115/3001 [02:49<58:40,  1.22s/it, loss=0.478, loss_mlm=1.25, lr=0.002, norm_mask=8.02, norm_target=12]Steps:   4%|▍         | 115/3001 [02:50<58:40,  1.22s/it, loss=0.0729, loss_mlm=0.71, lr=0.002, norm_mask=8.02, norm_target=12.1]Steps:   4%|▍         | 116/3001 [02:50<58:13,  1.21s/it, loss=0.0729, loss_mlm=0.71, lr=0.002, norm_mask=8.02, norm_target=12.1]Steps:   4%|▍         | 116/3001 [02:51<58:13,  1.21s/it, loss=0.0478, loss_mlm=0.81, lr=0.002, norm_mask=8.02, norm_target=12.1]Steps:   4%|▍         | 117/3001 [02:51<58:02,  1.21s/it, loss=0.0478, loss_mlm=0.81, lr=0.002, norm_mask=8.02, norm_target=12.1]Steps:   4%|▍         | 117/3001 [02:53<58:02,  1.21s/it, loss=0.0356, loss_mlm=0.607, lr=0.002, norm_mask=8.02, norm_target=12.1]Steps:   4%|▍         | 118/3001 [02:53<57:45,  1.20s/it, loss=0.0356, loss_mlm=0.607, lr=0.002, norm_mask=8.02, norm_target=12.1]Steps:   4%|▍         | 118/3001 [02:54<57:45,  1.20s/it, loss=0.0897, loss_mlm=0.758, lr=0.002, norm_mask=8.02, norm_target=12.1]Steps:   4%|▍         | 119/3001 [02:54<57:39,  1.20s/it, loss=0.0897, loss_mlm=0.758, lr=0.002, norm_mask=8.02, norm_target=12.1]Steps:   4%|▍         | 119/3001 [02:55<57:39,  1.20s/it, loss=0.0459, loss_mlm=0.96, lr=0.002, norm_mask=8.02, norm_target=12.2] Steps:   4%|▍         | 120/3001 [02:55<57:37,  1.20s/it, loss=0.0459, loss_mlm=0.96, lr=0.002, norm_mask=8.02, norm_target=12.2]Steps:   4%|▍         | 120/3001 [02:56<57:37,  1.20s/it, loss=0.2, loss_mlm=0.589, lr=0.002, norm_mask=8.02, norm_target=12.2]  Steps:   4%|▍         | 121/3001 [02:56<57:28,  1.20s/it, loss=0.2, loss_mlm=0.589, lr=0.002, norm_mask=8.02, norm_target=12.2]Steps:   4%|▍         | 121/3001 [02:57<57:28,  1.20s/it, loss=0.0234, loss_mlm=0.987, lr=0.002, norm_mask=8.02, norm_target=12.2]Steps:   4%|▍         | 122/3001 [02:57<57:22,  1.20s/it, loss=0.0234, loss_mlm=0.987, lr=0.002, norm_mask=8.02, norm_target=12.2]Steps:   4%|▍         | 122/3001 [02:59<57:22,  1.20s/it, loss=0.0576, loss_mlm=0.854, lr=0.002, norm_mask=8.02, norm_target=12.2]Steps:   4%|▍         | 123/3001 [02:59<1:01:43,  1.29s/it, loss=0.0576, loss_mlm=0.854, lr=0.002, norm_mask=8.02, norm_target=12.2]Steps:   4%|▍         | 123/3001 [03:00<1:01:43,  1.29s/it, loss=0.445, loss_mlm=0.712, lr=0.002, norm_mask=8.02, norm_target=12.3] Steps:   4%|▍         | 124/3001 [03:00<1:00:18,  1.26s/it, loss=0.445, loss_mlm=0.712, lr=0.002, norm_mask=8.02, norm_target=12.3]Steps:   4%|▍         | 124/3001 [03:01<1:00:18,  1.26s/it, loss=0.00452, loss_mlm=0.856, lr=0.002, norm_mask=8.02, norm_target=12.3]Steps:   4%|▍         | 125/3001 [03:01<59:19,  1.24s/it, loss=0.00452, loss_mlm=0.856, lr=0.002, norm_mask=8.02, norm_target=12.3]  Steps:   4%|▍         | 125/3001 [03:03<59:19,  1.24s/it, loss=0.0305, loss_mlm=0.931, lr=0.002, norm_mask=8.02, norm_target=12.3] Steps:   4%|▍         | 126/3001 [03:03<58:43,  1.23s/it, loss=0.0305, loss_mlm=0.931, lr=0.002, norm_mask=8.02, norm_target=12.3]Steps:   4%|▍         | 126/3001 [03:04<58:43,  1.23s/it, loss=0.00999, loss_mlm=0.908, lr=0.002, norm_mask=8.02, norm_target=12.3]Steps:   4%|▍         | 127/3001 [03:04<58:16,  1.22s/it, loss=0.00999, loss_mlm=0.908, lr=0.002, norm_mask=8.02, norm_target=12.3]Steps:   4%|▍         | 127/3001 [03:05<58:16,  1.22s/it, loss=0.00874, loss_mlm=0.992, lr=0.002, norm_mask=8.02, norm_target=12.4]Steps:   4%|▍         | 128/3001 [03:05<57:50,  1.21s/it, loss=0.00874, loss_mlm=0.992, lr=0.002, norm_mask=8.02, norm_target=12.4]Steps:   4%|▍         | 128/3001 [03:06<57:50,  1.21s/it, loss=0.067, loss_mlm=1.02, lr=0.002, norm_mask=8.02, norm_target=12.4]   Steps:   4%|▍         | 129/3001 [03:06<57:37,  1.20s/it, loss=0.067, loss_mlm=1.02, lr=0.002, norm_mask=8.02, norm_target=12.4]Steps:   4%|▍         | 129/3001 [03:07<57:37,  1.20s/it, loss=0.325, loss_mlm=1.02, lr=0.002, norm_mask=8.02, norm_target=12.4]Steps:   4%|▍         | 130/3001 [03:07<57:37,  1.20s/it, loss=0.325, loss_mlm=1.02, lr=0.002, norm_mask=8.02, norm_target=12.4]Steps:   4%|▍         | 130/3001 [03:08<57:37,  1.20s/it, loss=0.00396, loss_mlm=0.851, lr=0.002, norm_mask=8.02, norm_target=12.4]Steps:   4%|▍         | 131/3001 [03:08<57:29,  1.20s/it, loss=0.00396, loss_mlm=0.851, lr=0.002, norm_mask=8.02, norm_target=12.4]Steps:   4%|▍         | 131/3001 [03:10<57:29,  1.20s/it, loss=0.0201, loss_mlm=0.806, lr=0.002, norm_mask=8.02, norm_target=12.6] Steps:   4%|▍         | 132/3001 [03:10<57:23,  1.20s/it, loss=0.0201, loss_mlm=0.806, lr=0.002, norm_mask=8.02, norm_target=12.6]Steps:   4%|▍         | 132/3001 [03:11<57:23,  1.20s/it, loss=0.0791, loss_mlm=0.93, lr=0.002, norm_mask=8.02, norm_target=12.6] Steps:   4%|▍         | 133/3001 [03:11<57:16,  1.20s/it, loss=0.0791, loss_mlm=0.93, lr=0.002, norm_mask=8.02, norm_target=12.6]Steps:   4%|▍         | 133/3001 [03:12<57:16,  1.20s/it, loss=0.944, loss_mlm=1.25, lr=0.002, norm_mask=8.02, norm_target=12.6] Steps:   4%|▍         | 134/3001 [03:12<57:11,  1.20s/it, loss=0.944, loss_mlm=1.25, lr=0.002, norm_mask=8.02, norm_target=12.6]Steps:   4%|▍         | 134/3001 [03:13<57:11,  1.20s/it, loss=0.00324, loss_mlm=1.01, lr=0.002, norm_mask=8.02, norm_target=12.6]Steps:   4%|▍         | 135/3001 [03:13<57:03,  1.19s/it, loss=0.00324, loss_mlm=1.01, lr=0.002, norm_mask=8.02, norm_target=12.6]Steps:   4%|▍         | 135/3001 [03:14<57:03,  1.19s/it, loss=0.0332, loss_mlm=0.865, lr=0.002, norm_mask=8.02, norm_target=12.7]Steps:   5%|▍         | 136/3001 [03:14<56:58,  1.19s/it, loss=0.0332, loss_mlm=0.865, lr=0.002, norm_mask=8.02, norm_target=12.7]Steps:   5%|▍         | 136/3001 [03:16<56:58,  1.19s/it, loss=0.0935, loss_mlm=0.994, lr=0.002, norm_mask=8.02, norm_target=12.7]Steps:   5%|▍         | 137/3001 [03:16<56:58,  1.19s/it, loss=0.0935, loss_mlm=0.994, lr=0.002, norm_mask=8.02, norm_target=12.7]Steps:   5%|▍         | 137/3001 [03:17<56:58,  1.19s/it, loss=0.0978, loss_mlm=0.896, lr=0.002, norm_mask=8.02, norm_target=12.7]Steps:   5%|▍         | 138/3001 [03:17<56:54,  1.19s/it, loss=0.0978, loss_mlm=0.896, lr=0.002, norm_mask=8.02, norm_target=12.7]Steps:   5%|▍         | 138/3001 [03:18<56:54,  1.19s/it, loss=0.0774, loss_mlm=0.926, lr=0.002, norm_mask=8.02, norm_target=12.7]Steps:   5%|▍         | 139/3001 [03:18<56:49,  1.19s/it, loss=0.0774, loss_mlm=0.926, lr=0.002, norm_mask=8.02, norm_target=12.7]Steps:   5%|▍         | 139/3001 [03:19<56:49,  1.19s/it, loss=0.0103, loss_mlm=1.16, lr=0.002, norm_mask=8.02, norm_target=12.7] Steps:   5%|▍         | 140/3001 [03:19<56:51,  1.19s/it, loss=0.0103, loss_mlm=1.16, lr=0.002, norm_mask=8.02, norm_target=12.7]Steps:   5%|▍         | 140/3001 [03:20<56:51,  1.19s/it, loss=0.199, loss_mlm=0.815, lr=0.002, norm_mask=8.02, norm_target=12.7]Steps:   5%|▍         | 141/3001 [03:20<56:54,  1.19s/it, loss=0.199, loss_mlm=0.815, lr=0.002, norm_mask=8.02, norm_target=12.7]Steps:   5%|▍         | 141/3001 [03:22<56:54,  1.19s/it, loss=0.237, loss_mlm=1.31, lr=0.002, norm_mask=8.02, norm_target=12.7] Steps:   5%|▍         | 142/3001 [03:22<56:57,  1.20s/it, loss=0.237, loss_mlm=1.31, lr=0.002, norm_mask=8.02, norm_target=12.7]Steps:   5%|▍         | 142/3001 [03:23<56:57,  1.20s/it, loss=0.0632, loss_mlm=1.12, lr=0.002, norm_mask=8.02, norm_target=12.7]Steps:   5%|▍         | 143/3001 [03:23<56:56,  1.20s/it, loss=0.0632, loss_mlm=1.12, lr=0.002, norm_mask=8.02, norm_target=12.7]Steps:   5%|▍         | 143/3001 [03:24<56:56,  1.20s/it, loss=0.0953, loss_mlm=0.921, lr=0.002, norm_mask=8.02, norm_target=12.8]Steps:   5%|▍         | 144/3001 [03:24<1:01:12,  1.29s/it, loss=0.0953, loss_mlm=0.921, lr=0.002, norm_mask=8.02, norm_target=12.8]Steps:   5%|▍         | 144/3001 [03:25<1:01:12,  1.29s/it, loss=0.183, loss_mlm=1.03, lr=0.002, norm_mask=8.02, norm_target=12.8]  Steps:   5%|▍         | 145/3001 [03:26<59:52,  1.26s/it, loss=0.183, loss_mlm=1.03, lr=0.002, norm_mask=8.02, norm_target=12.8]  Steps:   5%|▍         | 145/3001 [03:27<59:52,  1.26s/it, loss=0.342, loss_mlm=0.819, lr=0.002, norm_mask=8.02, norm_target=12.8]Steps:   5%|▍         | 146/3001 [03:27<58:58,  1.24s/it, loss=0.342, loss_mlm=0.819, lr=0.002, norm_mask=8.02, norm_target=12.8]Steps:   5%|▍         | 146/3001 [03:28<58:58,  1.24s/it, loss=0.0656, loss_mlm=0.958, lr=0.002, norm_mask=8.02, norm_target=12.8]Steps:   5%|▍         | 147/3001 [03:28<58:15,  1.22s/it, loss=0.0656, loss_mlm=0.958, lr=0.002, norm_mask=8.02, norm_target=12.8]Steps:   5%|▍         | 147/3001 [03:29<58:15,  1.22s/it, loss=0.0231, loss_mlm=0.98, lr=0.002, norm_mask=8.02, norm_target=12.9] Steps:   5%|▍         | 148/3001 [03:29<57:51,  1.22s/it, loss=0.0231, loss_mlm=0.98, lr=0.002, norm_mask=8.02, norm_target=12.9]Steps:   5%|▍         | 148/3001 [03:30<57:51,  1.22s/it, loss=0.249, loss_mlm=1.07, lr=0.002, norm_mask=8.02, norm_target=12.9] Steps:   5%|▍         | 149/3001 [03:30<57:28,  1.21s/it, loss=0.249, loss_mlm=1.07, lr=0.002, norm_mask=8.02, norm_target=12.9]Steps:   5%|▍         | 149/3001 [03:31<57:28,  1.21s/it, loss=0.0338, loss_mlm=0.824, lr=0.002, norm_mask=8.02, norm_target=12.9]Steps:   5%|▍         | 150/3001 [03:31<57:12,  1.20s/it, loss=0.0338, loss_mlm=0.824, lr=0.002, norm_mask=8.02, norm_target=12.9]Steps:   5%|▍         | 150/3001 [03:33<57:12,  1.20s/it, loss=0.0802, loss_mlm=0.796, lr=0.002, norm_mask=8.02, norm_target=12.9]Steps:   5%|▌         | 151/3001 [03:33<57:03,  1.20s/it, loss=0.0802, loss_mlm=0.796, lr=0.002, norm_mask=8.02, norm_target=12.9]Steps:   5%|▌         | 151/3001 [03:34<57:03,  1.20s/it, loss=0.00472, loss_mlm=1.18, lr=0.002, norm_mask=8.02, norm_target=13]  Steps:   5%|▌         | 152/3001 [03:34<56:52,  1.20s/it, loss=0.00472, loss_mlm=1.18, lr=0.002, norm_mask=8.02, norm_target=13]Steps:   5%|▌         | 152/3001 [03:35<56:52,  1.20s/it, loss=0.00519, loss_mlm=1.18, lr=0.002, norm_mask=8.02, norm_target=13]Steps:   5%|▌         | 153/3001 [03:35<56:45,  1.20s/it, loss=0.00519, loss_mlm=1.18, lr=0.002, norm_mask=8.02, norm_target=13]Steps:   5%|▌         | 153/3001 [03:36<56:45,  1.20s/it, loss=0.113, loss_mlm=0.884, lr=0.002, norm_mask=8.02, norm_target=13] Steps:   5%|▌         | 154/3001 [03:36<56:43,  1.20s/it, loss=0.113, loss_mlm=0.884, lr=0.002, norm_mask=8.02, norm_target=13]Steps:   5%|▌         | 154/3001 [03:37<56:43,  1.20s/it, loss=0.00406, loss_mlm=1.08, lr=0.002, norm_mask=8.02, norm_target=13]Steps:   5%|▌         | 155/3001 [03:37<56:35,  1.19s/it, loss=0.00406, loss_mlm=1.08, lr=0.002, norm_mask=8.02, norm_target=13]Steps:   5%|▌         | 155/3001 [03:39<56:35,  1.19s/it, loss=0.0808, loss_mlm=0.797, lr=0.002, norm_mask=8.02, norm_target=13.1]Steps:   5%|▌         | 156/3001 [03:39<56:22,  1.19s/it, loss=0.0808, loss_mlm=0.797, lr=0.002, norm_mask=8.02, norm_target=13.1]Steps:   5%|▌         | 156/3001 [03:40<56:22,  1.19s/it, loss=0.041, loss_mlm=1.12, lr=0.002, norm_mask=8.02, norm_target=13.1]  Steps:   5%|▌         | 157/3001 [03:40<56:18,  1.19s/it, loss=0.041, loss_mlm=1.12, lr=0.002, norm_mask=8.02, norm_target=13.1]Steps:   5%|▌         | 157/3001 [03:41<56:18,  1.19s/it, loss=0.0113, loss_mlm=0.872, lr=0.002, norm_mask=8.02, norm_target=13.1]Steps:   5%|▌         | 158/3001 [03:41<56:19,  1.19s/it, loss=0.0113, loss_mlm=0.872, lr=0.002, norm_mask=8.02, norm_target=13.1]Steps:   5%|▌         | 158/3001 [03:42<56:19,  1.19s/it, loss=0.196, loss_mlm=1.11, lr=0.002, norm_mask=8.02, norm_target=13.1]  Steps:   5%|▌         | 159/3001 [03:42<56:15,  1.19s/it, loss=0.196, loss_mlm=1.11, lr=0.002, norm_mask=8.02, norm_target=13.1]Steps:   5%|▌         | 159/3001 [03:43<56:15,  1.19s/it, loss=0.148, loss_mlm=0.833, lr=0.002, norm_mask=8.02, norm_target=13.2]Steps:   5%|▌         | 160/3001 [03:43<56:14,  1.19s/it, loss=0.148, loss_mlm=0.833, lr=0.002, norm_mask=8.02, norm_target=13.2]Steps:   5%|▌         | 160/3001 [03:45<56:14,  1.19s/it, loss=0.00396, loss_mlm=1.3, lr=0.002, norm_mask=8.02, norm_target=13.2]Steps:   5%|▌         | 161/3001 [03:45<56:26,  1.19s/it, loss=0.00396, loss_mlm=1.3, lr=0.002, norm_mask=8.02, norm_target=13.2]Steps:   5%|▌         | 161/3001 [03:46<56:26,  1.19s/it, loss=0.585, loss_mlm=0.969, lr=0.002, norm_mask=8.02, norm_target=13.2]Steps:   5%|▌         | 162/3001 [03:46<56:22,  1.19s/it, loss=0.585, loss_mlm=0.969, lr=0.002, norm_mask=8.02, norm_target=13.2]Steps:   5%|▌         | 162/3001 [03:47<56:22,  1.19s/it, loss=0.00773, loss_mlm=0.611, lr=0.002, norm_mask=8.02, norm_target=13.2]Steps:   5%|▌         | 163/3001 [03:47<56:25,  1.19s/it, loss=0.00773, loss_mlm=0.611, lr=0.002, norm_mask=8.02, norm_target=13.2]Steps:   5%|▌         | 163/3001 [03:48<56:25,  1.19s/it, loss=0.111, loss_mlm=1.23, lr=0.002, norm_mask=8.02, norm_target=13.3]   Steps:   5%|▌         | 164/3001 [03:48<56:20,  1.19s/it, loss=0.111, loss_mlm=1.23, lr=0.002, norm_mask=8.02, norm_target=13.3]Steps:   5%|▌         | 164/3001 [03:49<56:20,  1.19s/it, loss=0.204, loss_mlm=1.15, lr=0.002, norm_mask=8.02, norm_target=13.3]Steps:   5%|▌         | 165/3001 [03:49<56:18,  1.19s/it, loss=0.204, loss_mlm=1.15, lr=0.002, norm_mask=8.02, norm_target=13.3]Steps:   5%|▌         | 165/3001 [03:51<56:18,  1.19s/it, loss=0.12, loss_mlm=1.18, lr=0.002, norm_mask=8.02, norm_target=13.3] Steps:   6%|▌         | 166/3001 [03:51<1:00:33,  1.28s/it, loss=0.12, loss_mlm=1.18, lr=0.002, norm_mask=8.02, norm_target=13.3]Steps:   6%|▌         | 166/3001 [03:52<1:00:33,  1.28s/it, loss=0.0052, loss_mlm=1.16, lr=0.002, norm_mask=8.02, norm_target=13.3]Steps:   6%|▌         | 167/3001 [03:52<59:14,  1.25s/it, loss=0.0052, loss_mlm=1.16, lr=0.002, norm_mask=8.02, norm_target=13.3]  Steps:   6%|▌         | 167/3001 [03:53<59:14,  1.25s/it, loss=0.03, loss_mlm=0.85, lr=0.002, norm_mask=8.02, norm_target=13.4]  Steps:   6%|▌         | 168/3001 [03:53<58:18,  1.23s/it, loss=0.03, loss_mlm=0.85, lr=0.002, norm_mask=8.02, norm_target=13.4]Steps:   6%|▌         | 168/3001 [03:54<58:18,  1.23s/it, loss=0.0512, loss_mlm=0.525, lr=0.002, norm_mask=8.02, norm_target=13.4]Steps:   6%|▌         | 169/3001 [03:54<57:44,  1.22s/it, loss=0.0512, loss_mlm=0.525, lr=0.002, norm_mask=8.02, norm_target=13.4]Steps:   6%|▌         | 169/3001 [03:56<57:44,  1.22s/it, loss=0.214, loss_mlm=1.03, lr=0.002, norm_mask=8.02, norm_target=13.4]  Steps:   6%|▌         | 170/3001 [03:56<57:21,  1.22s/it, loss=0.214, loss_mlm=1.03, lr=0.002, norm_mask=8.02, norm_target=13.4]Steps:   6%|▌         | 170/3001 [03:57<57:21,  1.22s/it, loss=0.0764, loss_mlm=1.13, lr=0.002, norm_mask=8.02, norm_target=13.4]Steps:   6%|▌         | 171/3001 [03:57<57:17,  1.21s/it, loss=0.0764, loss_mlm=1.13, lr=0.002, norm_mask=8.02, norm_target=13.4]Steps:   6%|▌         | 171/3001 [03:58<57:17,  1.21s/it, loss=0.0312, loss_mlm=0.665, lr=0.002, norm_mask=8.02, norm_target=13.5]Steps:   6%|▌         | 172/3001 [03:58<57:19,  1.22s/it, loss=0.0312, loss_mlm=0.665, lr=0.002, norm_mask=8.02, norm_target=13.5]Steps:   6%|▌         | 172/3001 [03:59<57:19,  1.22s/it, loss=0.188, loss_mlm=0.58, lr=0.002, norm_mask=8.02, norm_target=13.5]  Steps:   6%|▌         | 173/3001 [03:59<57:04,  1.21s/it, loss=0.188, loss_mlm=0.58, lr=0.002, norm_mask=8.02, norm_target=13.5]Steps:   6%|▌         | 173/3001 [04:00<57:04,  1.21s/it, loss=0.0332, loss_mlm=0.773, lr=0.002, norm_mask=8.02, norm_target=13.5]Steps:   6%|▌         | 174/3001 [04:00<57:03,  1.21s/it, loss=0.0332, loss_mlm=0.773, lr=0.002, norm_mask=8.02, norm_target=13.5]Steps:   6%|▌         | 174/3001 [04:02<57:03,  1.21s/it, loss=0.333, loss_mlm=0.839, lr=0.002, norm_mask=8.02, norm_target=13.5] Steps:   6%|▌         | 175/3001 [04:02<56:52,  1.21s/it, loss=0.333, loss_mlm=0.839, lr=0.002, norm_mask=8.02, norm_target=13.5]Steps:   6%|▌         | 175/3001 [04:03<56:52,  1.21s/it, loss=0.217, loss_mlm=1.04, lr=0.002, norm_mask=8.02, norm_target=13.6] Steps:   6%|▌         | 176/3001 [04:03<56:36,  1.20s/it, loss=0.217, loss_mlm=1.04, lr=0.002, norm_mask=8.02, norm_target=13.6]Steps:   6%|▌         | 176/3001 [04:04<56:36,  1.20s/it, loss=0.00669, loss_mlm=1.04, lr=0.002, norm_mask=8.02, norm_target=13.6]Steps:   6%|▌         | 177/3001 [04:04<56:35,  1.20s/it, loss=0.00669, loss_mlm=1.04, lr=0.002, norm_mask=8.02, norm_target=13.6]Steps:   6%|▌         | 177/3001 [04:05<56:35,  1.20s/it, loss=0.0384, loss_mlm=0.785, lr=0.002, norm_mask=8.02, norm_target=13.6]Steps:   6%|▌         | 178/3001 [04:05<56:21,  1.20s/it, loss=0.0384, loss_mlm=0.785, lr=0.002, norm_mask=8.02, norm_target=13.6]Steps:   6%|▌         | 178/3001 [04:06<56:21,  1.20s/it, loss=0.091, loss_mlm=0.792, lr=0.002, norm_mask=8.02, norm_target=13.6] Steps:   6%|▌         | 179/3001 [04:06<56:26,  1.20s/it, loss=0.091, loss_mlm=0.792, lr=0.002, norm_mask=8.02, norm_target=13.6]Steps:   6%|▌         | 179/3001 [04:08<56:26,  1.20s/it, loss=0.14, loss_mlm=0.621, lr=0.002, norm_mask=8.02, norm_target=13.7] Steps:   6%|▌         | 180/3001 [04:08<56:28,  1.20s/it, loss=0.14, loss_mlm=0.621, lr=0.002, norm_mask=8.02, norm_target=13.7]Steps:   6%|▌         | 180/3001 [04:09<56:28,  1.20s/it, loss=0.0121, loss_mlm=0.928, lr=0.002, norm_mask=8.02, norm_target=13.7]Steps:   6%|▌         | 181/3001 [04:09<56:15,  1.20s/it, loss=0.0121, loss_mlm=0.928, lr=0.002, norm_mask=8.02, norm_target=13.7]Steps:   6%|▌         | 181/3001 [04:10<56:15,  1.20s/it, loss=0.28, loss_mlm=0.865, lr=0.002, norm_mask=8.02, norm_target=13.7]  Steps:   6%|▌         | 182/3001 [04:10<56:09,  1.20s/it, loss=0.28, loss_mlm=0.865, lr=0.002, norm_mask=8.02, norm_target=13.7]Steps:   6%|▌         | 182/3001 [04:11<56:09,  1.20s/it, loss=0.0566, loss_mlm=1.16, lr=0.002, norm_mask=8.02, norm_target=13.7]Steps:   6%|▌         | 183/3001 [04:11<55:59,  1.19s/it, loss=0.0566, loss_mlm=1.16, lr=0.002, norm_mask=8.02, norm_target=13.7]Steps:   6%|▌         | 183/3001 [04:12<55:59,  1.19s/it, loss=0.14, loss_mlm=0.925, lr=0.002, norm_mask=8.02, norm_target=13.8] Steps:   6%|▌         | 184/3001 [04:12<55:58,  1.19s/it, loss=0.14, loss_mlm=0.925, lr=0.002, norm_mask=8.02, norm_target=13.8]Steps:   6%|▌         | 184/3001 [04:14<55:58,  1.19s/it, loss=0.127, loss_mlm=1.21, lr=0.002, norm_mask=8.02, norm_target=13.8]Steps:   6%|▌         | 185/3001 [04:14<55:53,  1.19s/it, loss=0.127, loss_mlm=1.21, lr=0.002, norm_mask=8.02, norm_target=13.8]Steps:   6%|▌         | 185/3001 [04:15<55:53,  1.19s/it, loss=0.239, loss_mlm=1.01, lr=0.002, norm_mask=8.02, norm_target=13.8]Steps:   6%|▌         | 186/3001 [04:15<55:47,  1.19s/it, loss=0.239, loss_mlm=1.01, lr=0.002, norm_mask=8.02, norm_target=13.8]Steps:   6%|▌         | 186/3001 [04:16<55:47,  1.19s/it, loss=0.0359, loss_mlm=0.731, lr=0.002, norm_mask=8.02, norm_target=13.8]Steps:   6%|▌         | 187/3001 [04:16<59:57,  1.28s/it, loss=0.0359, loss_mlm=0.731, lr=0.002, norm_mask=8.02, norm_target=13.8]Steps:   6%|▌         | 187/3001 [04:17<59:57,  1.28s/it, loss=0.284, loss_mlm=0.768, lr=0.002, norm_mask=8.02, norm_target=13.9] Steps:   6%|▋         | 188/3001 [04:17<58:50,  1.26s/it, loss=0.284, loss_mlm=0.768, lr=0.002, norm_mask=8.02, norm_target=13.9]Steps:   6%|▋         | 188/3001 [04:19<58:50,  1.26s/it, loss=0.422, loss_mlm=0.823, lr=0.002, norm_mask=8.02, norm_target=13.9]Steps:   6%|▋         | 189/3001 [04:19<58:09,  1.24s/it, loss=0.422, loss_mlm=0.823, lr=0.002, norm_mask=8.02, norm_target=13.9]Steps:   6%|▋         | 189/3001 [04:20<58:09,  1.24s/it, loss=0.0207, loss_mlm=0.789, lr=0.002, norm_mask=8.02, norm_target=13.9]Steps:   6%|▋         | 190/3001 [04:20<57:46,  1.23s/it, loss=0.0207, loss_mlm=0.789, lr=0.002, norm_mask=8.02, norm_target=13.9]Steps:   6%|▋         | 190/3001 [04:21<57:46,  1.23s/it, loss=0.751, loss_mlm=1.26, lr=0.002, norm_mask=8.02, norm_target=13.9]  Steps:   6%|▋         | 191/3001 [04:21<57:07,  1.22s/it, loss=0.751, loss_mlm=1.26, lr=0.002, norm_mask=8.02, norm_target=13.9]Steps:   6%|▋         | 191/3001 [04:22<57:07,  1.22s/it, loss=0.0356, loss_mlm=0.971, lr=0.002, norm_mask=8.02, norm_target=14]Steps:   6%|▋         | 192/3001 [04:22<56:36,  1.21s/it, loss=0.0356, loss_mlm=0.971, lr=0.002, norm_mask=8.02, norm_target=14]Steps:   6%|▋         | 192/3001 [04:23<56:36,  1.21s/it, loss=0.104, loss_mlm=0.982, lr=0.002, norm_mask=8.02, norm_target=14] Steps:   6%|▋         | 193/3001 [04:23<56:20,  1.20s/it, loss=0.104, loss_mlm=0.982, lr=0.002, norm_mask=8.02, norm_target=14]Steps:   6%|▋         | 193/3001 [04:25<56:20,  1.20s/it, loss=0.543, loss_mlm=1.01, lr=0.002, norm_mask=8.02, norm_target=14] Steps:   6%|▋         | 194/3001 [04:25<56:11,  1.20s/it, loss=0.543, loss_mlm=1.01, lr=0.002, norm_mask=8.02, norm_target=14]Steps:   6%|▋         | 194/3001 [04:26<56:11,  1.20s/it, loss=0.289, loss_mlm=0.787, lr=0.002, norm_mask=8.02, norm_target=14]Steps:   6%|▋         | 195/3001 [04:26<55:56,  1.20s/it, loss=0.289, loss_mlm=0.787, lr=0.002, norm_mask=8.02, norm_target=14]Steps:   6%|▋         | 195/3001 [04:27<55:56,  1.20s/it, loss=0.0175, loss_mlm=0.732, lr=0.002, norm_mask=8.02, norm_target=14.1]Steps:   7%|▋         | 196/3001 [04:27<56:01,  1.20s/it, loss=0.0175, loss_mlm=0.732, lr=0.002, norm_mask=8.02, norm_target=14.1]Steps:   7%|▋         | 196/3001 [04:28<56:01,  1.20s/it, loss=0.186, loss_mlm=1.03, lr=0.002, norm_mask=8.02, norm_target=14.1]  Steps:   7%|▋         | 197/3001 [04:28<56:10,  1.20s/it, loss=0.186, loss_mlm=1.03, lr=0.002, norm_mask=8.02, norm_target=14.1]Steps:   7%|▋         | 197/3001 [04:29<56:10,  1.20s/it, loss=0.0148, loss_mlm=1.15, lr=0.002, norm_mask=8.02, norm_target=14.1]Steps:   7%|▋         | 198/3001 [04:29<56:02,  1.20s/it, loss=0.0148, loss_mlm=1.15, lr=0.002, norm_mask=8.02, norm_target=14.1]Steps:   7%|▋         | 198/3001 [04:31<56:02,  1.20s/it, loss=0.0751, loss_mlm=0.949, lr=0.002, norm_mask=8.02, norm_target=14.1]Steps:   7%|▋         | 199/3001 [04:31<55:52,  1.20s/it, loss=0.0751, loss_mlm=0.949, lr=0.002, norm_mask=8.02, norm_target=14.1]Steps:   7%|▋         | 199/3001 [04:32<55:52,  1.20s/it, loss=0.0766, loss_mlm=0.979, lr=0.002, norm_mask=8.02, norm_target=14.2]Steps:   7%|▋         | 200/3001 [04:32<56:31,  1.21s/it, loss=0.0766, loss_mlm=0.979, lr=0.002, norm_mask=8.02, norm_target=14.2]INFO:__main__:STEP 200 Running validation... 
 Generating 8 images with prompt: ['a <teapot> teapot in the jungle', 'a <teapot> teapot with a city in the background', 'a <teapot> teapot with a mountain in the background', 'a <teapot> teapot with the Eiffel Tower in the background', 'a <teapot> teapot floating on top of water', 'a <teapot> teapot floating in an ocean of milk', 'a <teapot> teapot on top of the sidewalk in a crowded street', 'a cube shaped <teapot> teapot'].
Generated


----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
Step		|200
Raw		|a          M[silver]  <teapot>   teapot    
Masked		|a          [MASK]     <teapot>   teapot    
Preds		|a          M[small]   teapot     teapot    
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------


  0%|          | 0/25 [00:00<?, ?it/s][A
  4%|▍         | 1/25 [00:00<00:08,  2.91it/s][A
  8%|▊         | 2/25 [00:00<00:07,  2.91it/s][A
 12%|█▏        | 3/25 [00:01<00:07,  2.91it/s][A
 16%|█▌        | 4/25 [00:01<00:07,  2.91it/s][A
 20%|██        | 5/25 [00:01<00:06,  2.91it/s][A
 24%|██▍       | 6/25 [00:02<00:06,  2.91it/s][A
 28%|██▊       | 7/25 [00:02<00:06,  2.92it/s][A
 32%|███▏      | 8/25 [00:02<00:05,  2.92it/s][A
 36%|███▌      | 9/25 [00:03<00:05,  2.92it/s][A
 40%|████      | 10/25 [00:03<00:05,  2.92it/s][A
 44%|████▍     | 11/25 [00:03<00:04,  2.92it/s][A
 48%|████▊     | 12/25 [00:04<00:04,  2.92it/s][A
 52%|█████▏    | 13/25 [00:04<00:04,  2.93it/s][A
 56%|█████▌    | 14/25 [00:04<00:03,  2.92it/s][A
 60%|██████    | 15/25 [00:05<00:03,  2.92it/s][A
 64%|██████▍   | 16/25 [00:05<00:03,  2.92it/s][A
 68%|██████▊   | 17/25 [00:05<00:02,  2.92it/s][A
 72%|███████▏  | 18/25 [00:06<00:02,  2.92it/s][A
 76%|███████▌  | 19/25 [00:06<00:02,  2.92it/s][A
 80%|████████  | 20/25 [00:06<00:01,  2.92it/s][A
 84%|████████▍ | 21/25 [00:07<00:01,  2.92it/s][A
 88%|████████▊ | 22/25 [00:07<00:01,  2.92it/s][A
 92%|█████████▏| 23/25 [00:07<00:00,  2.92it/s][A
 96%|█████████▌| 24/25 [00:08<00:00,  2.92it/s][A
100%|██████████| 25/25 [00:08<00:00,  2.92it/s][A100%|██████████| 25/25 [00:09<00:00,  2.66it/s]
Traceback (most recent call last):
  File "/home/twkim/anaconda3/envs/context/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/home/twkim/anaconda3/envs/context/lib/python3.9/site-packages/accelerate/commands/accelerate_cli.py", line 47, in main
    args.func(args)
  File "/home/twkim/anaconda3/envs/context/lib/python3.9/site-packages/accelerate/commands/launch.py", line 1023, in launch_command
    simple_launcher(args)
  File "/home/twkim/anaconda3/envs/context/lib/python3.9/site-packages/accelerate/commands/launch.py", line 643, in simple_launcher
    raise subprocess.CalledProcessError(returncode=process.returncode, cmd=cmd)
subprocess.CalledProcessError: Command '['/home/twkim/anaconda3/envs/context/bin/python', 'ti_train.py', '--pretrained_model_name_or_path=runwayml/stable-diffusion-v1-5', '--train_data_dir1=/data/twkim/diffusion/personalization/collected/images/teapot', '--learnable_property=object', '--placeholder_token1=<teapot>', '--use_det_alg=1', '--train_prior_concept1=teapot', '--eval_prior_concept1=teapot', '--resolution=512', '--train_batch_size=1', '--gradient_accumulation_steps=4', '--max_train_steps=3001', '--learning_rate=5e-4', '--lr_scheduler=constant', '--normalize_mask_embeds=0', '--lr_warmup_steps=0', '--output_dir=saved_models/ti_models/single_capv7_prior_seed2940_rep_test3/teapot', '--seed=2940', '--mask_tokens=[MASK]', '--lambda_mlm=0.001', '--freeze_mask_embedding=1', '--cls_net_path=saved_models/mlm_models/sd1_contextnetv4_nonpadding_1e4_unnorm_mprob015_batch150/checkpoints/checkpoint-100000/cls_net_100000_ckpt.pt', '--mask_embed_path=saved_models/mlm_models/sd1_contextnetv4_nonpadding_1e4_unnorm_mprob015_batch150/checkpoints/checkpoint-100000/mask_embeds_100000_ckpt.pt', '--mask_prob=0.15', '--mlm_target=masked', '--mlm_batch_size=25', '--scale_lr', '--eval_prompt_type=nonliving', '--train_prompt_type=nonliving', '--silent=0', '--rev=0', '--normalize_target1=0', '--caption_root=../datasets_pkgs/captions/v7', '--run_name=ti_cnetv4_prior_mlm0001_teapot_mprob015_mbatch25_use_det', '--include_prior_concept=1']' died with <Signals.SIGKILL: 9>.
439510306 worker_seed
489724171 worker_seed
439510307 worker_seed
489724168 worker_seed
439510308 worker_seed
489724169 worker_seed
439510309 worker_seed
489724170 worker_seed
