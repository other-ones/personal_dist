WARNING[XFORMERS]: xFormers can't load C++/CUDA extensions. xFormers was built for:
    PyTorch 2.1.1+cu121 with CUDA 1201 (you have 2.1.1+cu118)
    Python  3.9.18 (you have 3.9.19)
  Please reinstall xformers (see https://github.com/facebookresearch/xformers#installing-xformers)
  Memory-efficient attention, SwiGLU, sparse and more won't be available.
  Set XFORMERS_MORE_DETAILS=1 for more details
usage: ti_generate.py [-h] [--target_image TARGET_IMAGE]
                      [--use_det_alg USE_DET_ALG]
                      [--eval_prior_concept1 EVAL_PRIOR_CONCEPT1]
                      [--normalize_mask_embeds NORMALIZE_MASK_EMBEDS]
                      [--add_pe ADD_PE] [--benchmark_path BENCHMARK_PATH]
                      [--eval_prompt_type EVAL_PROMPT_TYPE]
                      [--train_prompt_type TRAIN_PROMPT_TYPE]
                      [--exclude_cap_types EXCLUDE_CAP_TYPES]
                      [--log_steps LOG_STEPS] [--rev REV]
                      [--caption_root CAPTION_ROOT]
                      [--initialize_token INITIALIZE_TOKEN]
                      [--calibrate_ppos1 CALIBRATE_PPOS1]
                      [--calibrate_ppos2 CALIBRATE_PPOS2]
                      [--calibrate_pneg1 CALIBRATE_PNEG1]
                      [--calibrate_pneg2 CALIBRATE_PNEG2]
                      [--calibrate_kpos1 CALIBRATE_KPOS1]
                      [--calibrate_kpos2 CALIBRATE_KPOS2]
                      [--calibrate_kneg1 CALIBRATE_KNEG1]
                      [--calibrate_kneg2 CALIBRATE_KNEG2]
                      [--dst_exp_path DST_EXP_PATH] [--run_name RUN_NAME]
                      [--mask_tokens MASK_TOKENS] [--mlm_weight MLM_WEIGHT]
                      [--freeze_mask_embedding FREEZE_MASK_EMBEDDING]
                      [--mlm_batch_size MLM_BATCH_SIZE]
                      [--cls_net_path CLS_NET_PATH]
                      [--mask_embed_path MASK_EMBED_PATH]
                      [--avg_norm AVG_NORM] [--mlm_target MLM_TARGET]
                      [--learn_prior LEARN_PRIOR]
                      [--project_name PROJECT_NAME]
                      [--target_scale TARGET_SCALE] [--flip_p FLIP_P]
                      [--output_dir OUTPUT_DIR]
                      [--mlm_caption_path MLM_CAPTION_PATH] [--debug]
                      [--prompt_type PROMPT_TYPE]
                      [--num_images_per_prompt NUM_IMAGES_PER_PROMPT]
                      [--eval_batch_size EVAL_BATCH_SIZE]
                      [--include_prior_concept INCLUDE_PRIOR_CONCEPT]
                      [--lambda_mlm LAMBDA_MLM]
                      [--lambda_contrastive LAMBDA_CONTRASTIVE]
                      [--lambda_sim LAMBDA_SIM] [--margin MARGIN]
                      [--mask_prob MASK_PROB]
                      [--learned_embed_path1 LEARNED_EMBED_PATH1]
                      [--learned_embed_path2 LEARNED_EMBED_PATH2]
                      [--train_data_dir1 TRAIN_DATA_DIR1]
                      [--train_data_dir2 TRAIN_DATA_DIR2]
                      [--placeholder_token1 PLACEHOLDER_TOKEN1]
                      [--placeholder_token2 PLACEHOLDER_TOKEN2]
                      [--masked_loss MASKED_LOSS]
                      [--augmenter_path1 AUGMENTER_PATH1]
                      [--augmenter_path2 AUGMENTER_PATH2]
                      [--learned_embed_path_multi LEARNED_EMBED_PATH_MULTI]
                      [--exp_name EXP_NAME]
                      [--make_composition MAKE_COMPOSITION]
                      [--display_steps DISPLAY_STEPS] [--silent SILENT]
                      [--normalize_target1 NORMALIZE_TARGET1]
                      [--normalize_target2 NORMALIZE_TARGET2]
                      [--sim_margin SIM_MARGIN]
                      [--dissim_layers DISSIM_LAYERS]
                      [--save_steps SAVE_STEPS] [--target_word TARGET_WORD]
                      [--exclude_suffix] [--save_as_full_pipeline]
                      [--num_vectors NUM_VECTORS]
                      --pretrained_model_name_or_path
                      PRETRAINED_MODEL_NAME_OR_PATH [--revision REVISION]
                      [--variant VARIANT] [--tokenizer_name TOKENIZER_NAME]
                      [--initializer_token INITIALIZER_TOKEN]
                      [--learnable_property LEARNABLE_PROPERTY]
                      [--repeats REPEATS] [--seed SEED]
                      [--resolution RESOLUTION] [--center_crop]
                      [--train_batch_size TRAIN_BATCH_SIZE]
                      [--num_train_epochs NUM_TRAIN_EPOCHS]
                      [--max_train_steps MAX_TRAIN_STEPS]
                      [--gradient_accumulation_steps GRADIENT_ACCUMULATION_STEPS]
                      [--gradient_checkpointing]
                      [--learning_rate LEARNING_RATE] [--scale_lr]
                      [--lr_scheduler LR_SCHEDULER]
                      [--lr_warmup_steps LR_WARMUP_STEPS]
                      [--lr_num_cycles LR_NUM_CYCLES]
                      [--dataloader_num_workers DATALOADER_NUM_WORKERS]
                      [--adam_beta1 ADAM_BETA1] [--adam_beta2 ADAM_BETA2]
                      [--adam_weight_decay ADAM_WEIGHT_DECAY]
                      [--adam_epsilon ADAM_EPSILON] [--hub_token HUB_TOKEN]
                      [--hub_model_id HUB_MODEL_ID]
                      [--logging_dir LOGGING_DIR]
                      [--mixed_precision {no,fp16,bf16}] [--allow_tf32]
                      [--report_to REPORT_TO]
                      [--validation_prompt VALIDATION_PROMPT]
                      [--num_validation_images NUM_VALIDATION_IMAGES]
                      [--validation_steps VALIDATION_STEPS]
                      [--validation_epochs VALIDATION_EPOCHS]
                      [--local_rank LOCAL_RANK]
                      [--checkpointing_steps CHECKPOINTING_STEPS]
                      [--checkpoints_total_limit CHECKPOINTS_TOTAL_LIMIT]
                      [--resume_from_checkpoint RESUME_FROM_CHECKPOINT]
                      [--enable_xformers_memory_efficient_attention]
                      [--no_safe_serialization]
ti_generate.py: error: unrecognized arguments: --train_prior_concept1=toy
Traceback (most recent call last):
  File "/home/twkim/anaconda3/envs/context/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/home/twkim/anaconda3/envs/context/lib/python3.9/site-packages/accelerate/commands/accelerate_cli.py", line 47, in main
    args.func(args)
  File "/home/twkim/anaconda3/envs/context/lib/python3.9/site-packages/accelerate/commands/launch.py", line 1023, in launch_command
    simple_launcher(args)
  File "/home/twkim/anaconda3/envs/context/lib/python3.9/site-packages/accelerate/commands/launch.py", line 643, in simple_launcher
    raise subprocess.CalledProcessError(returncode=process.returncode, cmd=cmd)
subprocess.CalledProcessError: Command '['/home/twkim/anaconda3/envs/context/bin/python', 'ti_generate.py', '--pretrained_model_name_or_path=runwayml/stable-diffusion-v1-5', '--train_data_dir1=/data/twkim/diffusion/personalization/collected/images/poop_emoji', '--placeholder_token1=<poop_emoji>', '--train_prior_concept1=toy', '--eval_prior_concept1=toy', '--resolution=512', '--dst_exp_path=results/ti_results/single_capv8_noprior_seed2940_rep1/poop_emoji/ti_cnetv4_noprior_mlm00001_poop_emoji_mprob015_mbatch25_s3000_ppos0', '--benchmark_path=../datasets_pkgs/eval_prompts/dreambooth.json', '--eval_batch_size=15', '--num_images_per_prompt=8', '--output_dir=results/ti_results/single_capv8_noprior_seed2940_rep1/poop_emoji', '--seed=2940', '--mask_tokens=[MASK]', '--learned_embed_path1=saved_models/ti_models/single_capv8_noprior_seed2940_rep1/poop_emoji/ti_cnetv4_noprior_mlm00001_poop_emoji_mprob015_mbatch25/checkpoints/learned_embeds_s3000.pt', '--calibrate_ppos1=0', '--rev=0', '--train_prompt_type=nonliving', '--eval_prompt_type=nonliving', '--include_prior_concept=1']' returned non-zero exit status 2.
